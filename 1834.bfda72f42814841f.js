(self.webpackChunkc8y_os_repo_overview=self.webpackChunkc8y_os_repo_overview||[]).push([[1834],{41834:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ALARM_STATUS_LABELS:()=>B,AlarmService:()=>F,AlarmStatus:()=>$,ApplicationAvailability:()=>ee,ApplicationBinaryService:()=>he,ApplicationService:()=>pe,ApplicationType:()=>Q,AuditRecordType:()=>re,AuditService:()=>me,BasicAuth:()=>y,BearerAuth:()=>b,BearerAuthFromSessionStorage:()=>T,BillingMode:()=>z,ChangeType:()=>se,ChildType:()=>H,Client:()=>Re,CookieAuth:()=>O,CrlService:()=>Ce,DeviceRegistrationBulkService:()=>Oe,DeviceRegistrationSecurityMode:()=>ae,DeviceRegistrationService:()=>Te,DeviceRegistrationStatus:()=>oe,EventBinaryService:()=>N,EventService:()=>_,FetchClient:()=>l,GrantType:()=>ne,IdentityService:()=>Ue,InstanceStatus:()=>Y,InventoryBinaryService:()=>D,InventoryRoleService:()=>be,InventoryService:()=>P,Isolation:()=>Z,MeasurementService:()=>L,MicroserviceClientRequestAuth:()=>S,NodeJSCookieAuth:()=>E,OperationBulkGeneralStatus:()=>V,OperationBulkService:()=>G,OperationBulkStatus:()=>q,OperationService:()=>M,OperationStatus:()=>J,Paging:()=>r,PasswordStrength:()=>K,QueriesUtil:()=>C,Realtime:()=>R,SEVERITY_LABELS:()=>w,Service:()=>s,Severity:()=>U,SmartGroupsService:()=>je,SmartRulesService:()=>Ae,SystemOptionsService:()=>fe,TenantLoginOptionType:()=>te,TenantLoginOptionsService:()=>ye,TenantOptionsService:()=>ge,TenantSecurityOptionsService:()=>ve,TenantService:()=>le,TenantStatus:()=>W,TfaStrategy:()=>X,TrustedCertificateService:()=>we,UserGroupService:()=>Ee,UserInventoryRoleService:()=>ue,UserManagementSource:()=>ie,UserRoleService:()=>Se,UserService:()=>de,aggregationType:()=>k});var i=n(31635);class r{constructor(e,t,n){this.filter=n,this.service=e,this.currentPage=t.currentPage,this.nextPage=t.nextPage,this.prevPage=t.prevPage,this.pageSize=t.pageSize,this.totalPages=t.totalPages}next(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.list(this.getFilter(e,this.nextPage))}))}prev(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.list(this.getFilter(e,this.prevPage))}))}list(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.service.list(e)}))}goto(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.list(this.getFilter(t,e))}))}getFilter(e,t){return Object.assign(e,this.filter,{currentPage:t})}}class s{constructor(e,t){this.client=e,this.realtime=t,this.cache=new Map;const n=Object.getPrototypeOf(this);["list","create","update","detail","delete"].forEach((e=>{n.hasOwnProperty(e)||Object.defineProperty(this,e,{get(){}})}))}list(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.listUrl,n=yield this.fetch(t,this.changeFetchOptions({headers:{accept:"application/json"},params:e},t)),i=yield n.json();return{res:n,data:this.propertyName?i[this.propertyName]:i,paging:this.getPaging(i,e)}}))}detail(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getDetailUrl(e),i=yield this.fetch(n,this.changeFetchOptions({headers:{accept:"application/json"},params:Object.assign({},t)},n)),r=yield i.json();return{res:i,data:r}}))}create(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.listUrl,n=JSON.stringify(this.onBeforeCreate(e)),i=yield this.fetch(t,this.changeFetchOptions({method:"POST",body:n,headers:{"content-type":"application/json",accept:"application/json"}},t)),r=yield i.json();return{res:i,data:r}}))}update(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getDetailUrl(e),n=JSON.stringify(this.onBeforeUpdate(e)),i=yield this.fetch(t,this.changeFetchOptions({method:"PUT",body:n,headers:{"content-type":"application/json",accept:"application/json"}},t)),r=yield i.json();return{res:i,data:r}}))}delete(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getDetailUrl(e);return{res:yield this.fetch(n,this.changeFetchOptions({method:"DELETE",params:t},n)),data:null}}))}onBeforeCreate(e){return delete e.id,e}onBeforeUpdate(e){return e}changeFetchOptions(e,t=""){return e}getUrl(e=""){return`${this.baseUrl.replace(/\/+$/,"")}/${e.replace(/^\/+/,"")}`}getEntityId(e){return null==e?"":"object"==typeof e?this.getEntityId(e.id):`${e}`}getDetailUrl(e){const t=this.getEntityId(e);return`${this.listUrl}/${t}`}fetch(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getUrl(e),i=yield this.client.fetch(n,t);return yield this.handleErrorStatusCodes(i)}))}handleErrorStatusCodes(e){return(0,i.sH)(this,void 0,void 0,(function*(){if(e.status>=400){let t=null;try{t=yield e.json()}catch(n){try{t=yield e.text()}catch(e){}}throw{res:e,data:t}}return e}))}mimeType(e){return`application/vnd.com.nsn.cumulocity.${e}+json`}getIdString(e){let t;return t="object"==typeof e?e.id:e,String(t)}getPaging(e,t){if(e.statistics){const n=Object.assign(Object.assign({},e.statistics),{nextPage:this.getCurrentPageFromLink(e.next),prevPage:this.getCurrentPageFromLink(e.prev)});return new r(this,n,t)}return null}getCurrentPageFromLink(e=""){const t=e.match(/currentPage=(-{0,1}\d+)/);return t&&parseInt(t[1],10)}}var o=n(48055),a=n.n(o);let c=new WeakMap;class l{constructor(e,t){this.baseUrl=t,this.tenant="",this.defaultHeaders={},"string"==typeof e?t=e:this.setAuth(e),this.baseUrl=this.resolveServerUrl(t)}setAuth(e){c.set(this,e)}fetch(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){let n=a();try{n=window.fetch||n}catch(e){}const i=this.getUrl(e,t),r=this.getFetchOptions(t);return n(i,this.adjustOptionsForFormData(r))}))}getUrl(e="",t){const n=t&&t.params;let i="";n&&Object.keys(n).length&&(i=Object.keys(n).map((e=>{let t=n[e];const i=encodeURIComponent(e);return Array.isArray(t)||(t=[t]),t.map((e=>`${i}=${encodeURIComponent(e)}`)).join("&")})).join("&"),i=`?${i}`);return`${this.baseUrl.replace(/\/+$/,"").replace(/^\/+/,"")}/${e.replace(/\/+$/,"").replace(/^\/+/,"")}${i}`}getFetchOptions(e={}){let t=Object.assign({},e);const n=c.get(this);return t.headers=Object.assign({},this.defaultHeaders,t.headers,{UseXBasic:!0}),delete t.params,t=n?n.getFetchOptions(t):t,t}getCometdHandshake(e={}){const t=c.get(this);return t?t.getCometdHandshake(e):e}resolveServerUrl(e=""){if(e&&e.startsWith("http"))return e.replace(/\/+$/,"");try{const t=window.location;return`${t.protocol}//${t.host}/${e.replace(/\/+$/,"")}`}catch(e){throw Error("Your environment does not support relative URLs. Please provide a base URL.")}}adjustOptionsForFormData(e){return Object.assign(e,{body:e.body})}}var u=function(e){function t(){this.message=e}return t.prototype=new Error,t.prototype.name="InvalidCharacterError",t.prototype.code=5,t},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=u("The string to be encoded contains characters out of range"),p="undefined"!=typeof btoa?function(e){return btoa(e)}:function(e){for(var t,n,i=String(e),r="",s=0,o=d;i.charAt(0|s)||(o="=",s%1);r+=o.charAt(63&t>>8-s%1*8)){if((n=i.charCodeAt(s+=3/4))>255)throw new h;t=t<<8|n}return r};const f=function(e){return p(function(e){return encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)}))}(e))};var g=u("The string to be decoded is not correctly encoded");var v=new WeakMap;class y{constructor(e){this.updateCredentials(e)}updateCredentials({tenant:e,user:t,password:n,token:i,tfa:r}={}){const s=v.get(this)||{};return t&&e&&(t=`${e}/${t}`),t=t||this.user,n=n||s.password,!i&&t&&n&&(i=f(`${t}:${n}`)),t&&(this.user=t),i=i||s.token,r=r||s.tfa,v.set(this,{tfa:r,token:i,password:n}),i}getFetchOptions(e){const t=v.get(this),{token:n,tfa:i}=t,r=this.getCookieValue("XSRF-TOKEN"),s=Object.assign({Authorization:`Basic ${n||""}`},r?{"X-XSRF-TOKEN":r}:void 0);return i&&(s.tfatoken=i),e.headers=Object.assign(s,e.headers),e}getCometdHandshake(e={}){const t=v.get(this),{token:n,tfa:i}=t,r="com.cumulocity.authn",s=e.ext=e.ext||{};return s[r]=Object.assign(s[r]||{},{token:n,tfa:i}),e}logout(){delete this.user,v.set(this,{})}getCookieValue(e){try{const t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():void 0}catch(e){return}}}const m=new WeakMap;class b{constructor(e){m.set(this,{token:e})}getFetchOptions(e){const t=this.getToken();return e.headers=Object.assign({Authorization:`Bearer ${t}`},e.headers),e}updateCredentials({token:e}){m.set(this,{token:e})}getCometdHandshake(e={}){const t=m.get(this),{tfa:n}=t,i=this.getToken(),r="com.cumulocity.authn",s=e.ext=e.ext||{};return s[r]=Object.assign(s[r]||{},{token:i,tfa:n}),e}logout(){m.set(this,{})}getToken(){const e=m.get(this),{token:t}=e;return t}}class T extends b{constructor(e=!0){super();if(!this.getToken()&&e)throw new Error("No token present in session storage")}updateCredentials({token:e}){e&&super.updateCredentials({token:e})}getToken(){const e=sessionStorage.getItem(T.sessionStorageKey);if(e){return"true"===sessionStorage.getItem(T.sessionStorageKeyToKeepToken)||sessionStorage.removeItem(T.sessionStorageKey),this.updateCredentials({token:e}),e}return super.getToken()}}T.sessionStorageKey="bearerAuthToken",T.sessionStorageKeyToKeepToken="bearerAuthTokenKeep";class O{constructor(){this.logoutUrl="user/logout"}updateCredentials({user:e}={}){this.user=e}getFetchOptions(e){const t={"X-XSRF-TOKEN":this.getCookieValue("XSRF-TOKEN")};return e.headers=Object.assign(t,e.headers),e}getCometdHandshake(e={}){const t="com.cumulocity.authn",n=this.getCookieValue("XSRF-TOKEN"),i=e.ext=e.ext||{};return i[t]=Object.assign(i[t]||{},{xsrfToken:n}),e}logout(){return(0,i.sH)(this,void 0,void 0,(function*(){this.user&&delete this.user;const e=new l;e.setAuth(this);const t=JSON.stringify({});return e.fetch(this.logoutUrl,{headers:{"content-type":"application/json",accept:"application/json"},body:t,method:"POST"})}))}getCookieValue(e){const t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}}class S{constructor(e={}){this.xsrfToken=this.getCookieValue(e,"XSRF-TOKEN"),this.authTokenFromCookie=this.getCookieValue(e,"authorization"),this.authTokenFromHeader=e.authorization}updateCredentials(){}getFetchOptions(e){const t=Object.assign({Authorization:this.authTokenFromCookie?`Bearer ${this.authTokenFromCookie}`:this.authTokenFromHeader},this.xsrfToken?{"X-XSRF-TOKEN":this.xsrfToken}:void 0);return e.headers=Object.assign(t,e.headers),e}getCometdHandshake(e={}){const t="com.cumulocity.authn",n=this.xsrfToken;let i=this.authTokenFromCookie;!i&&this.authTokenFromHeader&&(i=this.authTokenFromHeader.replace("Basic ","").replace("Bearer ",""));const r=e.ext=e.ext||{};return r[t]=Object.assign(r[t]||{},Object.assign({token:i},n?{xsrfToken:n}:void 0)),e}logout(){this.authTokenFromCookie&&delete this.authTokenFromCookie,this.authTokenFromHeader&&delete this.authTokenFromHeader,this.xsrfToken&&delete this.xsrfToken}getCookieValue(e,t){try{const n=e&&e.cookie&&e.cookie.match("(^|;)\\s*"+t+"\\s*=\\s*([^;]+)");return n?n.pop():void 0}catch(e){return}}}class E extends S{constructor(e){super();const t=e.headers.get("set-cookie");if(!t)throw Error("No Cookie set");this.authTokenFromCookie=this.getCookieValue({cookie:t},"authorization")}}const U={CRITICAL:"CRITICAL",MAJOR:"MAJOR",MINOR:"MINOR",WARNING:"WARNING"},w={CRITICAL:"Critical`alarm`",MAJOR:"Major`alarm`",MINOR:"Minor`alarm`",WARNING:"Warning`alarm`"};class C{constructor(){this.operatorFns={__not:e=>`not(${this.buildQueryFilter(e,null)})`,__and:e=>this.buildQueryFilter(e,null,"and"),__or:e=>this.buildQueryFilter(e,null,"or"),__eq:(e,t)=>"object"==typeof e&&null!==e?this.buildQueryFilter(e,t):`${t} eq ${this.quoteString(e)}`,__gt:(e,t)=>`${t} gt ${this.quoteString(e)}`,__ge:(e,t)=>`${t} ge ${this.quoteString(e)}`,__lt:(e,t)=>`${t} lt ${this.quoteString(e)}`,__le:(e,t)=>`${t} le ${this.quoteString(e)}`,__in:(e,t)=>{const n=e.filter((e=>!!e)).map((e=>`${t} eq ${this.quoteString(e)}`));return this.glue(n,"or")},__bygroupid:e=>`bygroupid(${e})`,__has:e=>`has(${e})`,__useFilterQueryString:e=>{var t;const n=null===(t=e.match(/\(.*\)/))||void 0===t?void 0:t[0];return null==n?void 0:n.substring(1,n.length-1)}}}buildQuery(e){const t=[],n=this.buildQueryFilter(e.__filter||e),i=this.buildQueryOrderby(e.__orderby);return n&&t.push(`$filter=(${n})`),i&&t.push(`$orderby=${i}`),t.join(" ")}buildQueryFilter(e,t,n){const i=t||null,r=n||"and",s=[];if(Array.isArray(e))e.forEach((e=>{const t=this.buildQueryFilter(e,null,r);t&&s.push(t)}));else{let t;Object.keys(e).forEach((n=>{void 0!==this.operatorFns[n]?(t=this.operatorFns[n](e[n],i),t&&s.push(t)):(t=this.operatorFns.__eq(e[n],n),t&&s.push(t))}))}return this.glue(s,r)}buildQueryOrderby(e){const t=[];return e&&e.forEach((e=>{Object.keys(e).forEach((n=>{0!==e[n]&&t.push(`${n} ${e[n]>0?"asc":"desc"}`)}))})),t.join(",")}addAndFilter(e,t){return this.addFilter(e,t,"and")}addOrFilter(e,t){return this.addFilter(e,t,"or")}addFilter(e,t,n){const i=e.__orderby?e.__filter||{}:e.__filter||e,r={[`__${n}`]:this.skipEmptyObjects([i,t])};return e.__filter||e.__orderby?(e.__filter=r,e):r}prependOrderbys(e,t){return this.addOrderbys(e,t,"prepend")}appendOrderbys(e,t){return this.addOrderbys(e,t,"append")}addOrderbys(e,t,n){const i=e.__orderby?e.__filter||{}:e.__filter||e,r=e.__orderby||[],s="prepend"===n?[...t,...r]:[...r,...t],o={__orderby:this.skipEmptyObjects(s)};return this.isEmptyObject(i)||(o.__filter=i),o}extractAndMergeOrderBys(e){if((null==e?void 0:e.length)>0){const t=e.map((e=>{const t="$orderby=",n=e.lastIndexOf(t);return-1!==n?e.substring(n+9):null})).filter((e=>null!==e)).join(",");return t?`$orderby=${t}`:""}}glue(e,t){return e.length>1?`(${e.join(`) ${t} (`)})`:e[0]}quoteString(e){return"string"==typeof e?`'${this.escapeSingleQuote(e)}'`:e}skipEmptyObjects(e){return e.filter((e=>!this.isEmptyObject(e)))}isEmptyObject(e){return 0===Object.keys(e).length}escapeSingleQuote(e){return"string"!=typeof e?e:e.replace(/\'/g,"''")}}var j,A=n(56893);!function(e){e.HANDSHAKE="/meta/handshake",e.CONNECT="/meta/connect",e.SUBSCRIBE="/meta/subscribe",e.UNSUBSCRIBE="/meta/unsubscribe"}(j||(j={}));class R{constructor(e,t="/notification/realtime",n){this.client=e,this.url=t,this.metaHandshake=e=>{if(!e.successful)throw new Error("Handshake failed")},this.cometd=new A.CometD({}),this.cometd.websocketEnabled=!0,this.cometd.addListener(j.HANDSHAKE,n||this.metaHandshake)}subscribe(e,t){return this.checkConnection(),this.cometd.subscribe(e,t)}unsubscribe(e){return this.cometd.unsubscribe(e)}addHandshakeListener(e){return this.cometd.addListener(j.HANDSHAKE,e)}addConnectListener(e){return this.cometd.addListener(j.CONNECT,e)}removeListener(e){return this.cometd.removeListener(e)}resubscribe(e){return this.cometd.resubscribe(e)}disconnect(e=void 0){this.cometd.disconnect(e)}isDisconnected(){return this.cometd.isDisconnected()}checkConnection(){const{cometd:e,client:t,url:n}=this;if(e.isDisconnected()){const{headers:i}=t.getFetchOptions(),r={url:t.getUrl(n),requestHeaders:i};e.configure(r),this.handshake(t.getCometdHandshake())}}handshake(e){this.cometd.handshake(e,void 0)}}class _ extends s{constructor(){super(...arguments),this.baseUrl="event",this.listUrl="events",this.propertyName="events",this.channel="/events/*"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}}var H,k,I=n(57312),x=n.n(I);class N extends s{constructor(){super(...arguments),this.baseUrl="event",this.listUrl="events"}upload(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getDetailUrl(t),i=new(x());i.append("file",e);const r=yield this.fetch(n,{method:"POST",body:i,headers:{accept:"application/json"}}),s=yield r.json();return{res:r,data:s}}))}download(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getDetailUrl(e);return yield this.fetch(t)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}getDetailUrl(e){let t;return t="object"==typeof e&&e.id?e.id:e,`${this.listUrl}/${t}/binaries`}}class D extends s{constructor(){super(...arguments),this.baseUrl="inventory",this.listUrl="binaries",this.propertyName="managedObjects"}create(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.listUrl,i=new(x());let r,s;t.fileName&&(r=t.fileName,delete t.fileName),t.fileType&&(s=t.fileType,delete t.fileType),r||(r="bin"),"undefined"!=typeof File&&e instanceof File&&(r=e.name,s=e.type),t.name||(t.name=r),t.type||(t.type=s||"c8y_upload"),i.append("file",e,r),i.append("object",JSON.stringify(t));const o=yield this.fetch(n,{method:"POST",body:i,headers:{accept:"application/json"}}),a=yield o.json();return{res:o,data:a}}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}download(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getDetailUrl(e);return yield this.fetch(n,t)}))}createWithProgress(e,t,n={}){const i=`/${this.baseUrl}/${this.listUrl}`,r=new(x());let s,o,a;n.fileName&&(s=n.fileName,delete n.fileName),n.fileType&&(o=n.fileType,delete n.fileType),s||(s="bin"),"undefined"!=typeof File&&e instanceof File&&(s=e.name,o=e.type),n.name||(n.name=s),n.type||(n.type=o||"c8y_upload"),r.append("file",e,s),r.append("object",JSON.stringify(n)),"function"==typeof r.getHeaders&&(a=r.getHeaders());const c=this.client.getFetchOptions().headers;Object.assign(c,{accept:"application/json"},a);const l=new XMLHttpRequest;l.open("POST",i,!0);for(const e in c)c.hasOwnProperty(e)&&l.setRequestHeader(e,c[e]);let u;return l.upload.addEventListener("progress",t),u="function"==typeof r.getBuffer?r.getBuffer():r,l.send(u),l}getXMLHttpResponse(e){return new Promise(((t,n)=>{e.addEventListener("loadend",(()=>{4!==e.readyState||200!==e.status&&201!==e.status?n(e.responseText?{data:JSON.parse(e.responseText)}:"Could not upload file."):t(JSON.parse(e.responseText))}))}))}getIdFromUrl(e){if(e){const t=new RegExp("\\/inventory\\/binaries\\/(\\d+)|\\/inventory\\/managedObjects\\/(\\d+)"),n=e.match(t);return n&&(n[1]||n[2])}}}!function(e){e.ASSETS="childAssets",e.DEVICES="childDevices",e.ADDITIONS="childAdditions"}(H||(H={}));class P extends s{constructor(e,t){super(e,t),this.baseUrl="inventory",this.listUrl="managedObjects",this.propertyName="managedObjects",this.channel="/managedobjects/*",this.inventoriesQueryParamName="query",this.devicesQueryParamName="q",this.queriesUtil=new C,this.binary=new D(e)}detail(e,t={}){const n=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return n.detail.call(this,e,t)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}count(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/count`,n=yield this.fetch(t,this.changeFetchOptions({params:e},t)),i=yield n.json();return{res:n,data:i}}))}listQuery(e,t={}){const n=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t[this.inventoriesQueryParamName]=this.queriesUtil.buildQuery(e),n.list.call(this,t)}))}listQueryDevices(e,t={}){const n=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t[this.devicesQueryParamName]=this.queriesUtil.buildQuery(e),n.list.call(this,t)}))}delete(e,t={}){const n=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return n.delete.call(this,e,t)}))}childAdditionsList(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.listChildren(H.ADDITIONS,e,t)}))}childAdditionsCreate(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.createChild(H.ADDITIONS,e,t)}))}childAdditionsAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChild(H.ADDITIONS,e,t)}))}childAdditionsBulkAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChildBulk(H.ADDITIONS,e,t)}))}childAdditionsRemove(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.removeChild(H.ADDITIONS,e,t)}))}childAssetsList(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.listChildren(H.ASSETS,e,t)}))}childAssetsCreate(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.createChild(H.ASSETS,e,t)}))}childAssetsAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChild(H.ASSETS,e,t)}))}childAssetsBulkAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChildBulk(H.ASSETS,e,t)}))}childAssetsRemove(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.removeChild(H.ASSETS,e,t)}))}childDevicesList(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.listChildren(H.DEVICES,e,t)}))}childDevicesCreate(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.createChild(H.DEVICES,e,t)}))}childDevicesAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChild(H.DEVICES,e,t)}))}childDevicesBulkAdd(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChildBulk(H.DEVICES,e,t)}))}childDevicesRemove(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.removeChild(H.DEVICES,e,t)}))}getSupportedMeasurements(e){return(0,i.sH)(this,void 0,void 0,(function*(){return this.getSupportedMeasurementDetails(e,"supportedMeasurements")}))}getSupportedSeries(e){return(0,i.sH)(this,void 0,void 0,(function*(){return this.getSupportedMeasurementDetails(e,"supportedSeries")}))}getMeasurementsAndSeries(e){return(0,i.sH)(this,void 0,void 0,(function*(){const[t,n]=yield Promise.all([this.getSupportedMeasurements(e),this.getSupportedSeries(e)]),i=t.sort(((e,t)=>t.length-e.length));return n.map((e=>{const t=i.find((t=>0===e.indexOf(`${t}.`)));return{fragment:t,series:e.replace(`${t}.`,"")}})).filter((e=>!!e.fragment))}))}assetKPIsList(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){return this.listKPIs(e,t)}))}listKPIs(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getChildrenUrl("kpis",e),i=yield this.fetch(n,this.changeFetchOptions({headers:{accept:"application/json"},params:t},n)),r=yield i.json();return{res:i,data:r[this.propertyName],paging:this.getPaging(r,t)}}))}onBeforeUpdate(e){return delete e.lastUpdated,e}onBeforeCreate(e){return delete e.id,delete e.lastUpdated,e}getChildrenUrl(e,t){return`${this.getDetailUrl(t)}/${e}`}getChildUrl(e,t,n){const i=this.getIdString(t);return`${this.getChildrenUrl(e,n)}/${i}`}listChildren(e,t,n={}){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getChildrenUrl(e,t),r=yield this.fetch(i,{headers:{"content-type":"application/json"},params:n}),s=yield r.json(),o=s.references.map((e=>e.managedObject)),a=this.getPaging(s,n);return a.list=n=>this.listChildren(e,t,n),{res:r,data:o,paging:a}}))}createChild(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getChildrenUrl(e,n),r=JSON.stringify(this.onBeforeCreate(t)),s={"content-type":this.mimeType("managedObject"),accept:"application/json"},o=yield this.fetch(i,{method:"POST",body:r,headers:s}),a=yield o.json();return{res:o,data:a}}))}addChild(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getChildrenUrl(e,n),r=this.getIdString(t),s=JSON.stringify({managedObject:{id:String(r)}}),o={accept:"application/json","content-type":this.mimeType("managedObjectReference")},a=yield this.fetch(i,{method:"POST",body:s,headers:o});let c=yield a.json();return c=c.managedObject,{res:a,data:c}}))}addChildBulk(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getChildrenUrl(e,n),r=t.map((e=>({managedObject:{id:this.getIdString(e)}}))),s=JSON.stringify({references:r}),o={accept:"application/json","content-type":this.mimeType("managedObjectReferenceCollection")},a=yield this.fetch(i,{method:"POST",body:s,headers:o}),c=(yield a.json()).references;return{res:a,data:c.map((e=>e.managedObject))}}))}removeChild(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getIdString(t),r=`${this.getChildrenUrl(e,n)}/${i}`;return{res:yield this.fetch(r,{method:"DELETE",headers:{accept:"application/json"}}),data:null}}))}getSupportedMeasurementDetails(e,t="supportedSeries"){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`${this.getDetailUrl(e)}/${t}`;this.getIdString(e);const i=yield this.fetch(n,{headers:{accept:"application/json"}}),r=yield i.json();return r.c8y_SupportedMeasurements||r.c8y_SupportedSeries}))}}class L extends s{constructor(){super(...arguments),this.baseUrl="measurement",this.listUrl="measurements",this.propertyName="measurements",this.channel="/measurements/*"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,this.onBeforeCreate(e))}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}listSeries(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.baseUrl}/${this.listUrl}/series`,n=yield this.client.fetch(t,{params:e}),i=yield n.json();return{res:n,data:i}}))}onBeforeCreate(e){if(e.time||(e.time=(new Date).toISOString()),e.type||(e.type="c8y_Measurement"),e.sourceId){const{sourceId:t}=e;delete e.sourceId,e.source||(e.source={id:String(t)})}return e}}!function(e){e.MINUTELY="MINUTELY",e.HOURLY="HOURLY",e.DAILY="DAILY"}(k||(k={}));class F extends s{constructor(){super(...arguments),this.baseUrl="alarm",this.listUrl="alarms",this.propertyName="alarms",this.channel="/alarms/*"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}updateBulk(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new URLSearchParams(Object.entries(t).map((([e,t])=>[e,String(t)]))),i=this.getDetailUrl(e).replace(/\/$/,"")+`?${n.toString()}`,r=JSON.stringify(this.onBeforeUpdate(e));return yield this.fetch(i,this.changeFetchOptions({method:"PUT",body:r,headers:{"content-type":"application/json",accept:"application/json"}},i))}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}count(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/count`,n=yield this.fetch(t,this.changeFetchOptions({params:e},t)),i=yield n.json();return{res:n,data:i}}))}}const $={ACKNOWLEDGED:"ACKNOWLEDGED",CLEARED:"CLEARED",ACTIVE:"ACTIVE"},B={ACKNOWLEDGED:"Acknowledged`alarm`",CLEARED:"Cleared`alarm`",ACTIVE:"Active`alarm`"};class M extends s{constructor(){super(...arguments),this.baseUrl="devicecontrol",this.listUrl="operations",this.propertyName="operations"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}}class G extends s{constructor(){super(...arguments),this.baseUrl="devicecontrol",this.listUrl="bulkoperations",this.propertyName="bulkOperations"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}}var q,V,J,W,X,K,Q,Y,z,Z,ee,te,ne,ie,re,se,oe,ae,ce;!function(e){e[e.ACTIVE="ACTIVE"]="ACTIVE",e[e.IN_PROGRESS="IN_PROGRESS"]="IN_PROGRESS",e[e.COMPLETED="COMPLETED"]="COMPLETED",e[e.DELETED="DELETED"]="DELETED"}(q||(q={})),function(e){e[e.SCHEDULED="SCHEDULED"]="SCHEDULED",e[e.EXECUTING="EXECUTING"]="EXECUTING",e[e.EXECUTING_WITH_ERROR="EXECUTING_WITH_ERROR"]="EXECUTING_WITH_ERROR",e[e.CANCELED="CANCELED"]="CANCELED",e[e.FAILED="FAILED"]="FAILED",e[e.SUCCESSFUL="SUCCESSFUL"]="SUCCESSFUL",e[e.DELETED="DELETED"]="DELETED",e[e.INCORRECT="INCORRECT"]="INCORRECT"}(V||(V={})),function(e){e[e.PENDING="PENDING"]="PENDING",e[e.EXECUTING="EXECUTING"]="EXECUTING",e[e.SUCCESSFUL="SUCCESSFUL"]="SUCCESSFUL",e[e.FAILED="FAILED"]="FAILED"}(J||(J={}));class le extends s{constructor(){super(...arguments),this.baseUrl="tenant",this.listUrl="tenants",this.currentTenantUrl="currentTenant",this.propertyName="tenants",this.fetchOptions={method:"PUT",body:"{}",headers:{"content-type":"application/json",accept:"application/json"}}}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}current(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.fetch(this.currentTenantUrl,{headers:{"content-type":"application/json"}}),t=yield e.json();return{res:e,data:t}}))}enableSupportUser(){return(0,i.sH)(this,void 0,void 0,(function*(){return{res:yield this.fetch("support-user/enable",this.fetchOptions),data:null}}))}disableSupportUser(){return(0,i.sH)(this,void 0,void 0,(function*(){return{res:yield this.fetch("support-user/disable",this.fetchOptions),data:null}}))}currentTenantType(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.current();return e.data.customProperties&&"TRIAL"===e.data.customProperties.tenantType?"TRIAL":"REGULAR"}))}getTfaSettings(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`tenants/${this.getIdString(e)}/tfa`,n=yield this.fetch(t);return yield n.json()}))}updateTfaStrategy(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`tenants/${this.getIdString(e)}/tfa`,i=JSON.stringify({strategy:t});return{res:yield this.fetch(n,{method:"PUT",body:i,headers:{"content-type":"application/json",accept:"application/json"}}),data:null}}))}subscribeApplication(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getIdString(e),i=t.id,r=`tenants/${n}/applications`,s=JSON.stringify({application:{id:i,self:t.self}}),o={"content-type":this.mimeType("applicationReference")};return{res:yield this.fetch(r,this.changeFetchOptions({method:"POST",body:s,headers:o},r)),data:null}}))}unsubscribeApplication(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`tenants/${this.getIdString(e)}/applications/${t.id}`;return{res:yield this.fetch(n,this.changeFetchOptions({method:"DELETE"},n)),data:null}}))}getIdString(e){return e.id||e.name}onBeforeCreate(e){return e}}!function(e){e[e.ACTIVE="ACTIVE"]="ACTIVE",e[e.SUSPENDED="SUSPENDED"]="SUSPENDED"}(W||(W={})),function(e){e.TOTP="TOTP",e.SMS="SMS"}(X||(X={}));class ue extends s{constructor(e,t){super(t),this.listUrl="inventory",this.currenUserUrl="currentUser",this.propertyName="inventoryAssignments",this.baseUrl=`user/${e}/roles`}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}}class de extends s{constructor(){super(...arguments),this.baseUrl="user",this.currentUserUrl="currentUser",this.passwordResetUrl="passwordReset",this.currentUserPhoneUrl="currentUserPhone",this.verifyTFACodeUrl="pin",this.totpCurrentUserURL=`${this.currentUserUrl}/totpSecret`,this.verifyTOTPCodeUrl=`${this.totpCurrentUserURL}/verify`,this.activateTOTPCodeUrl=`${this.totpCurrentUserURL}/activity`,this.revokeTOTPSecretUrl="totpSecret/revoke",this.propertyName="users"}get listUrl(){return`${this.client.tenant}/users`}get newsletterEmailsUrl(){return`${this.client.tenant}/users/newsletterEmails`}get currentUserPasswordUrl(){return`${this.currentUserUrl}/password`}get revokeAllTokensUrl(){return`/logout/${this.client.tenant}/allUsers`}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}inventoryAssignment(e){return new ue(this.getDetailUrl(e),this.client)}current(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.fetch(this.currentUserUrl,{headers:{"content-type":"application/json",Accept:"application/vnd.com.nsn.cumulocity.user+json;"}}),t=yield e.json();return{res:e,data:t}}))}currentWithEffectiveRoles(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.fetch(this.currentUserUrl,{headers:{"content-type":"application/json",Accept:"application/vnd.com.nsn.cumulocity.currentUser+json;"}}),t=yield e.json();return{res:e,data:t}}))}updateCurrent(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t="application/vnd.com.nsn.cumulocity.user+json",n={"content-type":t,Accept:t},i=JSON.stringify(this.onBeforeUpdate(e)),r=yield this.fetch(this.currentUserUrl,{headers:n,body:i,method:"PUT"}),s=yield r.json();return{res:r,data:s}}))}sendPasswordResetMail(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.passwordResetUrl,i=t?{tenantId:t}:{},r=JSON.stringify({email:e});return{res:yield this.fetch(n,{headers:{"content-type":"application/json",accept:"application/json"},method:"POST",params:i,body:r}),data:null}}))}resetPassword(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.passwordResetUrl,i=t?{tenantId:t}:{},r=JSON.stringify(e);return{res:yield this.fetch(n,{headers:{"content-type":"application/json",accept:"application/json"},method:"PUT",params:i,body:r}),data:null}}))}verifyTFACode(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=JSON.stringify({pin:e});return{res:yield this.fetch(this.verifyTFACodeUrl,{headers:{"content-type":"application/json",accept:"application/json"},body:t,method:"POST"}),data:null}}))}verifyTotpCode(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=JSON.stringify({code:e});return{res:yield this.fetch(this.verifyTOTPCodeUrl,{headers:{"content-type":"application/json"},body:t,method:"POST"}),data:null}}))}activateTotp(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=JSON.stringify({isActive:!0});return{res:yield this.fetch(this.activateTOTPCodeUrl,{headers:{"content-type":"application/json"},body:e,method:"POST"}),data:null}}))}getActivityTotp(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.fetch(this.activateTOTPCodeUrl,{headers:{"content-type":"application/json"},method:"GET"}),t=yield e.json();return{res:e,data:t}}))}generateTotpSecret(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=yield this.fetch(this.totpCurrentUserURL,{headers:{"content-type":"application/json",accept:"application/json"},method:"POST"}),t=yield e.json();return{res:e,data:t}}))}totpRevokeSecret(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.getDetailUrl(e)}/${this.revokeTOTPSecretUrl}`;return{res:yield this.fetch(t,{headers:{accept:"application/json"},method:"DELETE"}),data:null}}))}savePhoneNumber(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.currentUserPhoneUrl,n={method:"PUT",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({phone:e})},i=yield this.fetch(t,n),r=yield i.json();return{res:i,data:r}}))}getNewsletterEmails(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=this.newsletterEmailsUrl,t=yield this.fetch(e,{method:"GET",headers:{accept:"text/plain"}}),n=yield t.text();return{res:t,data:n}}))}changeUserPassword(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=JSON.stringify({newPassword:t,currentUserPassword:n});return{res:yield this.fetch(this.changeUserPasswordUrl(e),{headers:{"content-type":"application/json"},body:i,method:"PUT"}),data:null}}))}changeCurrentUserPassword(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=JSON.stringify({newPassword:e,currentUserPassword:t});return{res:yield this.fetch(this.currentUserPasswordUrl,{headers:{"content-type":"application/json"},body:n,method:"PUT"}),data:null}}))}revokeTokens(){return(0,i.sH)(this,void 0,void 0,(function*(){return{res:yield this.fetch(this.revokeAllTokensUrl,{headers:{"content-type":"application/json"},method:"POST"}),data:null}}))}hasRole(e,t){return this.hasRoleInUser(e,t)||this.hasRoleInGroups(e,t)}hasAllRoles(e,t){return t.every((t=>this.hasRole(e,t)))}hasAnyRole(e,t){return t.some((t=>this.hasRole(e,t)))}hasAnyGlobalRole(e,t){return t.some((t=>this.hasGlobalRoleInUser(e,t)))}isDeviceUser(e){return e.id.match(/^device_/)}onBeforeUpdate(e){const t=Object.assign({},e);return delete t.id,delete t.userName,t}getDetailUrl(e){return`${this.listUrl}/${encodeURIComponent(this.getId(e))}`}getId(e){let t;return t="object"==typeof e&&e.id?e.id:"object"==typeof e&&e.userName?e.userName:e,String(t)}hasRoleInUser(e,t){const n=e.effectiveRoles||[];return this.hasRoleInReferences(e&&e.roles&&e.roles.references||[],t)||n.some((({id:e})=>t===e))}hasRoleInGroups(e,t){return(e&&e.groups&&e.groups.references||[]).some((e=>this.hasRoleInReferences(e.group.roles.references,t)))}hasRoleInReferences(e,t){return e.some((e=>e.role.id===t))}changeUserPasswordUrl(e){return`${this.client.tenant}/users/${this.getId(e)}/password`}hasGlobalRoleInUser(e,t){var n;const i=((null===(n=null==e?void 0:e.groups)||void 0===n?void 0:n.references)||[]).map((e=>{var t;return null===(t=null==e?void 0:e.group)||void 0===t?void 0:t.id}));return i.some((e=>e===t))}}!function(e){e.GREEN="GREEN",e.RED="RED",e.YELLOW="YELLOW"}(K||(K={}));class he extends s{constructor(e,t){super(e),this.listUrl="binaries",this.propertyName="attachments",this.baseUrl=`application/applications/${this.getIdString(t)}`}upload(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=(null==n?void 0:n.listUrl)||this.listUrl,r=this.createBinaryRequestBody(e,t,n);let s;"function"==typeof r.getHeaders&&(s=r.getHeaders());const o=Object.assign((null==n?void 0:n.headers)||{Accept:"application/json"},s),a=yield this.fetch(i,{method:"POST",body:r,headers:o}),c=yield a.json();return{res:a,data:c}}))}uploadApplicationVersion(e,t,n=[]){return this.upload(e,e.name,{listUrl:"versions",headers:{Accept:"application/vnd.com.nsn.cumulocity.applicationVersion+json;charset=UTF-8;ver=0.9"},bodyFileProperty:"applicationBinary",requestBody:{applicationVersion:Object.assign({version:t},(null==n?void 0:n.length)&&{tags:n})}})}uploadWithProgressXhr(e,t,n,i){const r=`/${this.baseUrl}/${(null==i?void 0:i.listUrl)||this.listUrl}`,s=this.createBinaryRequestBody(e,n,i);let o;"function"==typeof s.getHeaders&&(o=s.getHeaders());const a=this.client.getFetchOptions().headers;Object.assign(a,(null==i?void 0:i.headers)||{Accept:"application/json"}),Object.assign(a,o);const c=new XMLHttpRequest;c.open("POST",r,!0);for(const e in a)a.hasOwnProperty(e)&&c.setRequestHeader(e,a[e]);let l;return c.upload.addEventListener("progress",t),l="function"==typeof s.getBuffer?s.getBuffer():s,c.send(l),c}getXMLHttpResponse(e){return new Promise(((t,n)=>{e.addEventListener("loadend",(()=>{4!==e.readyState||200!==e.status&&201!==e.status?n(e.responseText?{data:JSON.parse(e.responseText)}:"Could not upload file."):t(JSON.parse(e.responseText))}))}))}list(e){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}listPlugins(){return(0,i.sH)(this,void 0,void 0,(function*(){const e=`${this.listUrl}/plugins`,t=yield this.fetch(e,{headers:{accept:"application/json"}}),n=yield t.json();return{res:t,data:n}}))}addPlugin(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`${this.listUrl}/plugins/${encodeURIComponent(e)}`,i=new(x()),r=t instanceof ArrayBuffer?Buffer.from(t):t;i.append("file",r);const s=yield this.fetch(n,{method:"POST",body:i,headers:{accept:"application/json"}}),o=yield s.json();return{res:s,data:o}}))}removePlugin(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/plugins/${e}`,n=yield this.fetch(t,{method:"DELETE",headers:{accept:"application/json"}}),i=yield n.json();return{res:n,data:i}}))}updateFiles(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/files`,n=new(x());e.forEach((e=>{const t=e.contents instanceof ArrayBuffer?Buffer.from(e.contents):e.contents;n.append(e.path,t)}));const i=yield this.fetch(t,{method:"POST",body:n,headers:{accept:"application/json"}}),r=yield i.json();return{res:i,data:r}}))}downloadArchive(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/${e}`;return yield this.fetch(t)}))}createBinaryRequestBody(e,t,n){const i=new(x()),r=e instanceof ArrayBuffer?Buffer.from(e):e;let s=t;if("undefined"!=typeof File&&e instanceof File&&(s=e.name),i.append((null==n?void 0:n.bodyFileProperty)||"file",r,s),i.append("fileName",s),null==n?void 0:n.requestBody)for(const e in n.requestBody)n.requestBody.hasOwnProperty(e)&&i.append(e,JSON.stringify(n.requestBody[e]));return i}}!function(e){e.EXTERNAL="EXTERNAL",e.HOSTED="HOSTED",e.MICROSERVICE="MICROSERVICE",e.FEATURE="FEATURE"}(Q||(Q={}));class pe extends s{constructor(){super(...arguments),this.baseUrl="application",this.listUrl="applications",this.propertyName="applications",this.channel="/applications/*"}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}clone(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`${this.getDetailUrl(e)}/clone`;let i;t&&(i={version:t});const r=yield this.fetch(n,{method:"POST",body:"",headers:{"content-type":"application/json",accept:"application/json"},params:i}),s=yield r.json();return{res:r,data:s}}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}listVersions(e,t={}){var n;return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getEntityId(e),r=`${this.listUrl}/${i}/versions`,s={"content-type":"application/json"};try{const e=yield this.fetch(r,{headers:s,params:t}),i=null===(n=yield e.json())||void 0===n?void 0:n.applicationVersions;return{res:e,data:i}}catch(t){if(404===t.res.status){const{data:t,res:n}=yield this.detail(e);return{res:n,data:t.applicationVersions}}throw t}}))}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}listByName(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`applicationsByName/${encodeURIComponent(e)}`,n=yield this.fetch(t,{headers:{"content-type":"application/json"}}),i=yield n.json();return{res:n,data:i[this.propertyName]}}))}listByTenant(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new le(this.client),i=this.getIdString(e||(yield n.current()).data.name),r=`applicationsByTenant/${encodeURIComponent(i)}`,s=yield this.fetch(r,{headers:{"content-type":"application/json"},params:t}),o=yield s.json();return{res:s,data:o[this.propertyName]}}))}listByOwner(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new le(this.client),i=this.getIdString(e||(yield n.current()).data.name),r=`applicationsByOwner/${encodeURIComponent(i)}`,s=yield this.fetch(r,{headers:{"content-type":"application/json"},params:t}),o=yield s.json();return{res:s,data:o[this.propertyName]}}))}listByUser(e,t={}){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new de(this.client),i=this.getIdString(e||(yield n.current()).data),r=`applicationsByUser/${encodeURIComponent(i)}`,s=yield this.fetch(r,{headers:{"content-type":"application/json"},params:t}),o=yield s.json();return{res:s,data:o[this.propertyName]}}))}reactivateArchive(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.listUrl}/${e}/refresh`;return{res:yield this.fetch(t,{method:"POST",body:"",headers:{"content-type":"application/json",accept:"application/json"}}),data:null}}))}binary(e){return new he(this.client,e)}getHref(e){return e.type===Q.EXTERNAL?e.externalUrl:`/apps/${e.public?"public/":""}${e.contextPath}`}isAvailable(e){return(0,i.sH)(this,void 0,void 0,(function*(){const{res:t,data:n}=yield this.listByUser(void 0,{dropOverwrittenApps:!0,noPaging:!0});return{data:(n||[]).some((t=>"string"==typeof e?t.name===e||t.contextPath===e:this.isMatch(t,e))),res:t}}))}getStatusDetails(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getEntityId(e);return new P(this.client,this.realtime).list({type:`c8y_Application_${t}`})}))}getInstanceNames(e){let t=new Array;return e&&e.c8y_Status&&e.c8y_Status.instances&&(t=Object.keys(e.c8y_Status.instances)),t}getInstanceLog(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=`${this.getDetailUrl(e)}/logs/${t}`,r={accept:this.mimeType("applicationLogs")},s=yield this.fetch(i,{headers:r,params:n}),o=yield s.json();return{res:s,data:o}}))}updateApplicationConfig(e,t){var n;return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getEntityId(e),{data:r}=yield this.detail(i),s=(null==r?void 0:r.config)||{},o=Object.assign(Object.assign({},s),t),a=yield this.update({id:i,config:o});return null===(n=yield a)||void 0===n?void 0:n.data}))}getAppManifest(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new Date;let i;if(i=t?yield this.client.fetch(`/apps/${e.contextPath}@${t}/cumulocity.json?nocache=${n.getTime()}`):yield this.client.fetch(`/apps/${e.contextPath}/cumulocity.json?nocache=${n.getTime()}`),i.status>=400)throw new Error("No Cumulocity IoT manifest found.");return yield i.json()}))}storeAppManifest(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return yield this.binary(e).updateFiles([{path:"cumulocity.json",contents:JSON.stringify(t)}])}))}setPackageVersionTag(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=`${this.getDetailUrl(e)}/versions/${t}`,r=JSON.stringify({tags:n}),s=yield this.fetch(i,{method:"PUT",body:r,headers:{accept:"application/vnd.com.nsn.cumulocity.applicationVersion+json;charset=UTF-8;ver=0.9","content-type":"application/json"}}),o=yield s.json();return{res:s,data:o}}))}getManifestOfContextPath(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.getDetailUrl(e)}/manifest`,n=yield this.fetch(t),{application:i}=yield n.json();return{res:n,data:i}}))}deleteVersionPackage(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`${this.getDetailUrl(e)}/versions/`;return{res:yield this.fetch(n,this.changeFetchOptions({method:"DELETE",params:t},n)),data:null}}))}updateApplicationAvailability(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getEntityId(e);return yield this.update({id:n,availability:t})}))}isMatch(e,t){return Object.keys(t).every((n=>Array.isArray(e[n])&&Array.isArray(t[n])?t[n].every((t=>e[n].includes(t))):"object"==typeof e[n]&&null!==e[n]&&"object"==typeof t[n]&&null!==t[n]?this.isMatch(e[n],t[n]):e[n]===t[n]))}}!function(e){e.Up="Up",e.Unhealthy="Unhealthy",e.Down="Down",e.Unknown="Unknown"}(Y||(Y={})),function(e){e.SUBSCRIPTION="SUBSCRIPTION",e.RESOURCES="RESOURCES"}(z||(z={})),function(e){e.PER_TENANT="PER_TENANT",e.MULTI_TENANT="MULTI_TENANT"}(Z||(Z={})),function(e){e[e.MARKET="MARKET"]="MARKET",e[e.PRIVATE="PRIVATE"]="PRIVATE",e[e.SHARED="SHARED"]="SHARED"}(ee||(ee={}));class fe extends s{constructor(){super(...arguments),this.baseUrl="tenant/system",this.listUrl="options",this.propertyName="options"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}list(e={}){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.listUrl,n=yield this.fetch(t,{headers:{"content-type":"application/json"},params:e}),i=yield n.json();return{res:n,data:i[this.propertyName]}}))}getDetailUrl(e){return`${this.listUrl}/${e.category}/${e.key}`}onBeforeCreate(e){return e}}class ge extends s{constructor(){super(...arguments),this.baseUrl="tenant",this.listUrl="options",this.propertyName="options",this.securityOptionsCategories=["password"],this.securityOptionsListUrl="security-options",this.systemOptions="system"}detail(e,t={}){const n=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return n.detail.call(this,e,t)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}getDetailUrl(e){const t=encodeURIComponent(e.category),n=encodeURIComponent(e.key);return this.securityOptionsCategories.indexOf(e.category)>-1?`${this.securityOptionsListUrl}/${t}/${n}`:`${this.listUrl}/${t}/${n}`}onBeforeCreate(e){return e}}class ve extends s{constructor(){super(...arguments),this.baseUrl="tenant",this.listUrl="security-options",this.category="password",this.propertyName="options"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}getDetailUrl(e){return`${this.listUrl}/${this.category}/${e.key}`}onBeforeCreate(e){return e}}class ye extends s{constructor(){super(...arguments),this.baseUrl="tenant",this.listUrl="loginOptions",this.propertyName="loginOptions"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}listForCurrentTenant(){const e=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return e.list.call(this,{tenantId:this.client.tenant})}))}listForManagement(){const e=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return e.list.call(this,{management:!0})}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}save(e){return(0,i.sH)(this,void 0,void 0,(function*(){return e.id?this.update(e):this.create(e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}}!function(e){e.OAUTH2_INTERNAL="OAUTH2_INTERNAL",e.OAUTH2="OAUTH2",e.BASIC="BASIC"}(te||(te={})),function(e){e.AUTHORIZATION_CODE="AUTHORIZATION_CODE",e.PASSWORD="PASSWORD"}(ne||(ne={})),function(e){e.REMOTE="REMOTE",e.INTERNAL="INTERNAL"}(ie||(ie={}));class me extends s{constructor(){super(...arguments),this.baseUrl="audit",this.listUrl="auditRecords",this.propertyName="auditRecords"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}}!function(e){e.ALARM="Alarm",e.BULK_OPERATION="BulkOperation",e.CEP_MODULE="CepModule",e.EVENT="Event",e.INVENTORY="Inventory",e.INVENTORY_ROLE="InventoryRole",e.OPERATION="Operation",e.OPTION="Option",e.GROUP="Group",e.SMART_RULE="SmartRule",e.SYSTEM="SYSTEM",e.TENANT="Tenant",e.USER="User"}(re||(re={})),function(e){e[e.ADDED="ADDED"]="ADDED",e[e.REPLACED="REPLACED"]="REPLACED",e[e.REMOVED="REMOVED"]="REMOVED"}(se||(se={}));class be extends s{constructor(){super(...arguments),this.baseUrl="user",this.listUrl="inventoryroles",this.propertyName="roles"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}}!function(e){e[e.WAITING_FOR_CONNECTION="WAITING_FOR_CONNECTION"]="WAITING_FOR_CONNECTION",e[e.PENDING_ACCEPTANCE="PENDING_ACCEPTANCE"]="PENDING_ACCEPTANCE",e[e.ACCEPTED="ACCEPTED"]="ACCEPTED",e[e.BLOCKED="BLOCKED"]="BLOCKED"}(oe||(oe={}));class Te extends s{constructor(){super(...arguments),this.baseUrl="devicecontrol",this.listUrl="newDeviceRequests",this.propertyName="newDeviceRequests"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}accept(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getSecurityToken(e);let i={id:this.getIdString(e),status:oe.ACCEPTED};return n&&(i=Object.assign(Object.assign({},i),{securityToken:n})),t.update.call(this,i)}))}acceptAll(){const e=Object.create(null,{fetch:{get:()=>super.fetch}});return(0,i.sH)(this,void 0,void 0,(function*(){const t=yield e.fetch.call(this,`${this.listUrl}/acceptAll`,{method:"POST"}),n=yield t.json();return{res:t,data:n}}))}limit(){const e=Object.create(null,{fetch:{get:()=>super.fetch}});return(0,i.sH)(this,void 0,void 0,(function*(){const t=yield e.fetch.call(this,`${this.listUrl}/limit`),n=yield t.json();return{res:t,data:n}}))}bootstrap(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=this.getIdString(e),i=this.getSecurityToken(e),r=i?JSON.stringify({id:n,securityToken:i}):JSON.stringify({id:n}),s=`${this.baseUrl}/deviceCredentials`,{basicAuth:o}=t;let{basicAuthToken:a}=t;if(o){const{user:e,pass:t}=o;a=f(`${e}:${t}`)}const c={Authorization:`Basic ${a}`,accept:"application/json","content-type":"application/json"},l=yield this.client.fetch(s,{body:r,headers:c,method:"POST"}),u=yield l.json();if(l.status>400)throw{res:l,data:u};return{res:l,data:u}}))}onBeforeCreate(e){return e}onBeforeUpdate(e){const t=Object.assign({},e);return delete t.id,t}getDetailUrl(e){const t=encodeURIComponent(this.getEntityId(e));return`${this.listUrl}/${t}`}getSecurityToken(e){let t;return"object"==typeof e&&(t=e.securityToken?String(e.securityToken):void 0),t}}class Oe{constructor(e){this.client=e}create(e){return(0,i.sH)(this,void 0,void 0,(function*(){let t=e;const n=new(x());let i="bulk-registration.csv";if("undefined"!=typeof File&&t instanceof File){i=t.name;const e=/\.csv$/;t.name.match(e)&&(t=new File([t],t.name,{type:"text/csv"}))}n.append("file",t,i);const r=yield this.client.fetch("/devicecontrol/bulkNewDeviceRequests",{method:"POST",body:n,headers:{accept:"application/json"}}),s=yield r.json();return{res:r,data:s}}))}}!function(e){e.REQUIRED="REQUIRED",e.OPTIONAL="OPTIONAL",e.IGNORED="IGNORED"}(ae||(ae={}));class Se extends s{constructor(){super(...arguments),this.baseUrl="user",this.listUrl="roles",this.propertyName="roles"}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}}!function(e){e.ROLES="roles",e.USERS="users"}(ce||(ce={}));class Ee extends s{constructor(){super(...arguments),this.baseUrl="user",this.propertyName="groups"}get listUrl(){return`${this.client.tenant}/groups`}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}addRoleToGroup(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChild(ce.ROLES,e,t)}))}removeRoleFromGroup(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.removeChild(ce.ROLES,e,t)}))}addUserToGroup(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.addChild(ce.USERS,e,t)}))}removeUserFromGroup(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){return this.removeChild(ce.USERS,e,t)}))}getSelf(e){return"object"==typeof e&&e.self?e.self:e}getChildUrl(e,t){return`${this.getDetailUrl(t)}/${e}`}getChildReferenceAsBody(e,t){const n=this.getSelf(t);switch(e){case ce.ROLES:return JSON.stringify({role:{self:String(n)}});case ce.USERS:return JSON.stringify({user:{self:String(n)}})}throw new Error("UserGroupService -> getChild -> unsupported child type")}addChild(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getChildUrl(e,t),r=this.getChildReferenceAsBody(e,n),s=yield this.fetch(i,{method:"POST",body:r,headers:{accept:"application/json","content-type":"application/json"}});let o=yield s.json();return o=o.managedObject,{res:s,data:o}}))}removeChild(e,t,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=this.getIdString(n),r=`${this.getChildUrl(e,t)}/${encodeURIComponent(String(i))}`;return{res:yield this.fetch(r,{method:"DELETE",headers:{accept:"application/json"}}),data:null}}))}}class Ue{constructor(e){this.baseUrl="identity",this.propertyName="externalIds",this.client=e}list(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getExternalIdsOfGlobalIdUrl(e),n=yield this.fetch(t,{headers:{accept:"application/json"}}),i=yield n.json();return{res:n,data:i[this.propertyName]}}))}create(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=JSON.stringify(e),n=this.getExternalIdsOfGlobalIdUrl(e.managedObject.id),i=yield this.fetch(n,{headers:{"content-type":"application/json",accept:"application/json"},method:"POST",body:t}),r=yield i.json();return{res:i,data:r}}))}detail(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getExternalIdUrl(e),n=yield this.fetch(t,{headers:{accept:"application/json"}}),i=yield n.json();return{res:n,data:i}}))}delete(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getExternalIdUrl(e);return{res:yield this.fetch(t,{headers:{accept:"application/json"},method:"DELETE"}),data:null}}))}fetch(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=yield this.client.fetch(e,t);if(n.status>=400){let e=null;try{e=yield n.json()}catch(t){try{e=yield n.text()}catch(e){}}throw{res:n,data:e}}return n}))}getExternalIdsOfGlobalIdUrl(e){return`/${this.baseUrl}/globalIds/${e}/externalIds`}getExternalIdUrl(e){return`/${this.baseUrl}/externalIds/${e.type}/${e.externalId}`}}class we extends s{constructor(){super(...arguments),this.listUrl="trusted-certificates",this.proofOfPossessionUrl="trusted-certificates-pop",this.propertyName="certificates"}get baseUrl(){return`/tenant/tenants/${this.client.tenant}`}list(e={}){const t=Object.create(null,{list:{get:()=>super.list}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.list.call(this,e)}))}detail(e){const t=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.detail.call(this,e)}))}delete(e){const t=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.delete.call(this,e)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.create.call(this,e)}))}regeneratePoPVerificationCode(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=`${this.proofOfPossessionUrl}/${this.getEntityId(e)}/verification-code`,n=yield this.fetch(t,{headers:{"content-type":"application/json",Accept:"application/json"},method:"POST"}),i=yield n.json();return{res:n,data:i}}))}verifySignedVerificationCode(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=`${this.proofOfPossessionUrl}/${this.getEntityId(e)}/pop`,i=JSON.stringify({proofOfPossessionSignedVerificationCode:t}),r=yield this.fetch(n,{method:"POST",body:i,headers:{"content-type":"application/json",Accept:"application/json"}}),s=yield r.json();return{res:r,data:s}}))}getDetailUrl(e){const t=this.getEntityId(e);return`${this.listUrl}/${t}`}getEntityId(e){let t;return t="object"==typeof e&&e.fingerprint?e.fingerprint:e,t}}class Ce extends s{get baseUrl(){return"/tenant/trusted-certificates/settings/crl"}uploadCrls(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=JSON.stringify({crls:e});return{res:yield this.fetch("",{method:"PUT",body:t,headers:{"content-type":"application/json",Accept:"application/json"}}),data:null}}))}uploadCrlFile(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=new(x());t.append("file",e);return{res:yield this.fetch("",{method:"PUT",body:t,headers:{accept:"application/json"}}),data:null}}))}downloadCrlFile(e){return(0,i.sH)(this,void 0,void 0,(function*(){return yield this.fetch("",e)}))}}class je extends s{constructor(e){super(e),this.baseUrl="inventory",this.listUrl="managedObjects",this.SMART_GROUP_TYPE="c8y_DynamicGroup",this.SMART_GROUP_FRAGMENT_TYPE="c8y_IsDynamicGroup",this.COLUMNS_CONFIG_FRAGMENT="c8y_DeviceColumnsConfig",this.FILTER_CONFIG_FRAGMENT="c8y_DeviceFilterConfig",this.QUERY_STRING_FRAGMENT="c8y_DeviceQueryString"}detail(e,t={}){const n=Object.create(null,{detail:{get:()=>super.detail}});return(0,i.sH)(this,void 0,void 0,(function*(){return n.detail.call(this,e,t)}))}create(e){const t=Object.create(null,{create:{get:()=>super.create}});return(0,i.sH)(this,void 0,void 0,(function*(){const n=Object.assign(Object.assign(Object.assign({},e.smartGroup),{[this.QUERY_STRING_FRAGMENT]:e.deviceQueryString,[this.COLUMNS_CONFIG_FRAGMENT]:e.configurableColumns}),e.filterConfig&&{[this.FILTER_CONFIG_FRAGMENT]:e.filterConfig});return t.create.call(this,n)}))}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return(0,i.sH)(this,void 0,void 0,(function*(){return t.update.call(this,e)}))}delete(e,t={}){const n=Object.create(null,{delete:{get:()=>super.delete}});return(0,i.sH)(this,void 0,void 0,(function*(){const i=(yield this.detail(e,{withChildren:!1})).data;return yield n.delete.call(this,i,t)}))}isSmartGroup(e){const t=e.hasOwnProperty(this.SMART_GROUP_FRAGMENT_TYPE),n=e&&e.type===this.SMART_GROUP_TYPE;return t||n}getUrl(e=""){const t=e.replace(/^\/+/,"");return`${this.baseUrl.replace(/\/+$/,"")}/${t}`}}class Ae extends s{constructor(e){super(e),this.baseUrl="service/smartrule",this.rulesUrl="smartrules",this.unupdatableFields=["type","cepModuleId","creationTime","lastUpdated"],this.applicationService=new pe(e)}isMicroserviceAvailable(){return(0,i.sH)(this,void 0,void 0,(function*(){return void 0===this.microserviceAvailable&&(this.microserviceAvailable=(yield this.applicationService.isAvailable(Ae.microserviceName)).data),this.microserviceAvailable}))}listByContext(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.contextRulesUrl(e),n=yield this.fetch(t,{method:"GET"}),i=(yield n.json()).rules;return{res:n,data:i}}))}bulkDeactivateEnabledSources(e,t){if(0===t.length)return Promise.resolve({res:null,data:null});const{enabledSources:n}=e,i=this.disableEnabledSources(n,t),r=Object.assign({},e);return Object.assign(r,{enabledSources:i}),this.update(r)}update(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=this.getSmartRulesUrl(e),n=JSON.stringify(this.removeUnclonableFields(e,this.unupdatableFields)),i=yield this.fetch(t,{method:"PUT",body:n,headers:{"content-type":"application/json",accept:"application/json"}}),r=yield i.json();return{res:i,data:r}}))}disableEnabledSources(e=[],t){return e.filter((e=>!this.getListOfStringIds(t).includes(e)))}getListOfStringIds(e){return e.map((e=>"object"==typeof e&&e.id?e.id.toString():e.toString()))}getSmartRulesUrl(e){const t=e&&e.c8y_Context&&e.c8y_Context.id;let n=t?this.contextRulesUrl(t):this.rulesUrl;return e.id&&(n=`${n}/${e.id}`),n}removeUnclonableFields(e,t){const n=Object.assign({},e);return t.forEach((e=>{delete n[e]})),n}contextRulesUrl(e={}){return"object"==typeof e&&e.id?`managedObjects/${e.id}/smartrules`:`managedObjects/${e}/smartrules`}}Ae.microserviceName="smartrule";class Re{static authenticate(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new y(e),i=new l(n,t),r=yield this.getCurrentTenant(i),s=new Re(n,t);return s.core.tenant=r,s}))}static authenticateViaOAuthInternal(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=yield this.loginViaOAuthInternal(e,!0,t),i=new b(n),r=new l(i,t),s=e.tenant||(yield this.getCurrentTenant(r)),o=new Re(i,t);return o.core.tenant=s,o}))}static authenticateViaOAuthInternalCookie(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=yield this.loginViaOAuthInternal(e,!1,t);let i;i="undefined"==typeof document?new E(n):new O;const r=new l(i,t),s=e.tenant||(yield this.getCurrentTenant(r)),o=new Re(i,t);return o.core.tenant=s,o}))}static deviceBootstrap(e){return(0,i.sH)(this,void 0,void 0,(function*(){const{deviceId:t,timeout:n,baseUrl:i,basicAuthToken:r}=e;let{expire:s}=e;n&&!s&&(s=Date.now()+n);const o=new l(void 0,i),a=new Te(o);let c;try{const{data:e}=yield a.bootstrap(t,{basicAuthToken:r}),{username:n,password:s,tenantId:o}=e,l=new y({user:n,tenant:o,password:s});c=new Re(l,i),c.core.tenant=o}catch(t){if((!s||Date.now()<s)&&404===t.res.status)return Re.deviceBootstrap(Object.assign({expire:s},e));throw t}return c}))}static getMicroserviceSubscriptions(e,t){return(0,i.sH)(this,void 0,void 0,(function*(){const n=new l(new y(e),t),i=yield n.fetch("/application/currentApplication/subscriptions"),{users:r}=yield i.json();return r.map((({tenant:e,name:t,password:n})=>({tenant:e,user:t,password:n})))}))}static loginViaOAuthInternal(e,t=!0,n){return(0,i.sH)(this,void 0,void 0,(function*(){const i=new y(e),r=new l(i,n);let s="/tenant/oauth";t&&(s+="/token"),e.tenant&&(s+=`?tenant_id=${e.tenant}`);const o=new URLSearchParams({grant_type:"PASSWORD",username:e.user,password:e.password,tfa_code:e.tfa}),a=yield r.fetch(s,{method:"POST",body:o.toString(),headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8"}});if(200!==a.status)throw{res:a};if(t){return(yield a.json()).access_token}return a}))}static getCurrentTenant(e){return(0,i.sH)(this,void 0,void 0,(function*(){const t=new le(e),{data:n}=yield t.current();return n.name}))}constructor(e,t){const n=new l(e,t);this.realtime=new R(n),this.alarm=new F(n,this.realtime),this.application=new pe(n,this.realtime),this.audit=new me(n),this.core=n,this.deviceRegistration=new Te(n),this.deviceRegistrationBulk=new Oe(n),this.event=new _(n,this.realtime),this.inventory=new P(n,this.realtime),this.inventoryBinary=new D(n),this.inventoryRole=new be(n),this.measurement=new L(n,this.realtime),this.operation=new M(n),this.operationBulk=new G(n),this.options={security:new ve(n),system:new fe(n),login:new ye(n),tenant:new ge(n)},this.role=new be(n),this.tenant=new le(n),this.user=new de(n),this.userGroup=new Ee(n),this.userRole=new Se(n),this.identity=new Ue(n),this.smartGroups=new je(n),this.smartRules=new Ae(n)}setAuth(e){this.core.setAuth(e),this.realtime.disconnect()}}},57323:function(e){e.exports=function(){var e=function(){var e=0,t={};this.register=function(n){var i=++e;return t[i]=n,i},this.unregister=function(e){var n=t[e];return delete t[e],n},this.setTimeout=function(e,t){return window.setTimeout(e,t)},this.clearTimeout=function(e){window.clearTimeout(e)}};function t(){var e={};self.onmessage=function(t){var n=t.data,i=e[n.id];switch(n.type){case"setTimeout":e[n.id]=self.setTimeout((function(){delete e[n.id],self.postMessage({id:n.id})}),n.delay);break;case"clearTimeout":delete e[n.id],i&&self.clearTimeout(i);break;default:throw"Unknown command "+n.type}}}var n={isString:function(e){return null!=e&&("string"==typeof e||e instanceof String)},isArray:function(e){return null!=e&&e instanceof Array},inArray:function(e,t){for(var n=0;n<t.length;++n)if(e===t[n])return n;return-1}},i=function(){var e=[],t={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(n,i,r){for(var s=[],o=0;o<e.length;++o){var a=e[o];!0===t[a].accept(n,i,r)&&s.push(a)}return s},this.negotiateTransport=function(n,i,r,s){for(var o=0;o<e.length;++o)for(var a=e[o],c=0;c<n.length;++c)if(a===n[c]){var l=t[a];if(!0===l.accept(i,r,s))return l}return null},this.add=function(n,i,r){for(var s=!1,o=0;o<e.length;++o)if(e[o]===n){s=!0;break}return s||("number"!=typeof r?e.push(n):e.splice(r,0,n),t[n]=i),!s},this.find=function(n){for(var i=0;i<e.length;++i)if(e[i]===n)return t[n];return null},this.remove=function(n){for(var i=0;i<e.length;++i)if(e[i]===n){e.splice(i,1);var r=t[n];return delete t[n],r}return null},this.clear=function(){e=[],t={}},this.reset=function(n){for(var i=0;i<e.length;++i)t[e[i]].reset(n)}},r=function(){var e,t,i;this.registered=function(n,i){e=n,t=i},this.unregistered=function(){e=null,t=null},this._debug=function(){t._debug.apply(t,arguments)},this._mixin=function(){return t._mixin.apply(t,arguments)},this.getConfiguration=function(){return t.getConfiguration()},this.getAdvice=function(){return t.getAdvice()},this.setTimeout=function(e,n){return t.setTimeout(e,n)},this.clearTimeout=function(e){t.clearTimeout(e)},this.convertToMessages=function(e){if(n.isString(e))try{return JSON.parse(e)}catch(t){throw this._debug("Could not convert to JSON the following string",'"'+e+'"'),t}if(n.isArray(e))return e;if(null==e)return[];if(e instanceof Object)return[e];throw"Conversion Error "+e+", typeof "+typeof e},this.accept=function(e,t,n){throw"Abstract"},this.getType=function(){return e},this.getURL=function(){return i},this.setURL=function(e){i=e},this.send=function(e,t){throw"Abstract"},this.reset=function(t){this._debug("Transport",e,"reset",t?"initial":"retry")},this.abort=function(){this._debug("Transport",e,"aborted")},this.toString=function(){return this.getType()}};r.derive=function(e){function t(){}return t.prototype=e,new t};var s=function(){var e=new r,t=r.derive(e),i=0,s=null,o=[],a=[];function c(e){for(;a.length>0;){var t=a[0],n=t[0],i=t[1];if(n.url!==e.url||n.sync!==e.sync)break;a.shift(),e.messages=e.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",i.id)}}function l(e,t){if(this.transportSend(e,t),t.expired=!1,!e.sync){var n=this.getConfiguration().maxNetworkDelay,i=n;!0===t.metaConnect&&(i+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",i,"ms for the response, maxNetworkDelay",n);var r=this;t.timeout=this.setTimeout((function(){t.expired=!0;var n="Request "+t.id+" of transport "+r.getType()+" exceeded "+i+" ms max network delay",s={reason:n},o=t.xhr;s.httpCode=r.xhrStatus(o),r.abortXHR(o),r._debug(n),r.complete(t,!1,t.metaConnect),e.onFailure(o,e.messages,s)}),i)}}function u(e){var t=++i,n={id:t,metaConnect:!1,envelope:e};o.length<this.getConfiguration().maxConnections-1?(o.push(n),l.call(this,e,n)):(this._debug("Transport",this.getType(),"queueing request",t,"envelope",e),a.push([e,n]))}function d(e){var t=e.id;if(this._debug("Transport",this.getType(),"/meta/connect complete, request",t),null!==s&&s.id!==t)throw"/meta/connect request mismatch, completing request "+t;s=null}function h(e,t){var i=n.inArray(e,o);if(i>=0&&o.splice(i,1),a.length>0){var r=a.shift(),s=r[0],l=r[1];if(this._debug("Transport dequeued request",l.id),t)this.getConfiguration().autoBatch&&c.call(this,s),u.call(this,s),this._debug("Transport completed request",e.id,s);else{var d=this;this.setTimeout((function(){d.complete(l,!1,l.metaConnect);var e={reason:"Previous request failed"},t=l.xhr;e.httpCode=d.xhrStatus(t),s.onFailure(t,s.messages,e)}),0)}}}function p(e){if(null!==s)throw"Concurrent /meta/connect requests not allowed, request id="+s.id+" not yet completed";var t=++i;this._debug("Transport",this.getType(),"/meta/connect send, request",t,"envelope",e);var n={id:t,metaConnect:!0,envelope:e};l.call(this,e,n),s=n}return t.complete=function(e,t,n){n?d.call(this,e):h.call(this,e,t)},t.transportSend=function(e,t){throw"Abstract"},t.transportSuccess=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!0,t.metaConnect),n&&n.length>0?e.onSuccess(n):e.onFailure(t.xhr,e.messages,{httpCode:204}))},t.transportFailure=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!1,t.metaConnect),e.onFailure(t.xhr,e.messages,n))},t.send=function(e,t){t?p.call(this,e):u.call(this,e)},t.abort=function(){e.abort();for(var t=0;t<o.length;++t){var n=o[t];n&&(this._debug("Aborting request",n),this.abortXHR(n.xhr)||this.transportFailure(n.envelope,n,{reason:"abort"}))}var i=s;i&&(this._debug("Aborting /meta/connect request",i),this.abortXHR(i.xhr)||this.transportFailure(i.envelope,i,{reason:"abort"})),this.reset(!0)},t.reset=function(t){e.reset(t),s=null,o=[],a=[]},t.abortXHR=function(e){if(e)try{var t=e.readyState;return e.abort(),t!==window.XMLHttpRequest.UNSENT}catch(e){this._debug(e)}return!1},t.xhrStatus=function(e){if(e)try{return e.status}catch(e){this._debug(e)}return-1},t},o=function(){var e=new s,t=r.derive(e),n=!0;function i(e){try{e.context=t.context}catch(e){this._debug("Could not copy transport context into XHR",e)}}return t.accept=function(e,t,i){return n||!t},t.newXMLHttpRequest=function(){return new window.XMLHttpRequest},t.xhrSend=function(e){var n=t.newXMLHttpRequest();i(n),n.withCredentials=!0,n.open("POST",e.url,!0!==e.sync);var r=e.headers;if(r)for(var s in r)r.hasOwnProperty(s)&&n.setRequestHeader(s,r[s]);return n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){200===n.status?e.onSuccess(n.responseText):e.onError(n.statusText)},n.onabort=n.onerror=function(){e.onError(n.statusText)},n.send(e.body),n},t.transportSend=function(e,t){this._debug("Transport",this.getType(),"sending request",t.id,"envelope",e);var i=this;try{var r=!0;t.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(e.messages),onSuccess:function(r){i._debug("Transport",i.getType(),"received response",r);var s=!1;try{var o=i.convertToMessages(r);0===o.length?(n=!1,i.transportFailure(e,t,{httpCode:204})):(s=!0,i.transportSuccess(e,t,o))}catch(r){if(i._debug(r),!s){n=!1;var a={exception:r};a.httpCode=i.xhrStatus(t.xhr),i.transportFailure(e,t,a)}}},onError:function(s,o){i._debug("Transport",i.getType(),"received error",s,o),n=!1;var a={reason:s,exception:o};a.httpCode=i.xhrStatus(t.xhr),r?i.setTimeout((function(){i.transportFailure(e,t,a)}),0):i.transportFailure(e,t,a)}}),r=!1}catch(r){n=!1,this.setTimeout((function(){i.transportFailure(e,t,{exception:r})}),0)}},t.reset=function(t){e.reset(t),n=!0},t},a=function(){var e=new s,t=r.derive(e),n=0;function i(e,t,n){var i=this;return function(){i.transportFailure(e,t,"error",n)}}return t.accept=function(e,t,n){return!0},t.jsonpSend=function(e){var t=document.getElementsByTagName("head")[0],i=document.createElement("script"),r="_cometd_jsonp_"+n++;window[r]=function(n){t.removeChild(i),delete window[r],e.onSuccess(n)};var s=e.url;s+=s.indexOf("?")<0?"?":"&",s+="jsonp="+r,s+="&message="+encodeURIComponent(e.body),i.src=s,i.async=!0!==e.sync,i.type="application/javascript",i.onerror=function(t){e.onError("jsonp "+t.type)},t.appendChild(i)},t.transportSend=function(e,t){for(var n=this,r=0,s=e.messages.length,o=[];s>0;){var a=JSON.stringify(e.messages.slice(r,r+s)),c=e.url.length+encodeURI(a).length,l=this.getConfiguration().maxURILength;if(c>l){if(1===s){var u="Bayeux message too big ("+c+" bytes, max is "+l+") for transport "+this.getType();return void this.setTimeout(i.call(this,e,t,u),0)}--s}else o.push(s),r+=s,s=e.messages.length-r}var d=e;if(o.length>1){var h=0,p=o[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",o.join(" + ")),(d=this._mixin(!1,{},e)).messages=e.messages.slice(h,p),d.onSuccess=e.onSuccess,d.onFailure=e.onFailure;for(var f=1;f<o.length;++f){var g=this._mixin(!1,{},e);h=p,p+=o[f],g.messages=e.messages.slice(h,p),g.onSuccess=e.onSuccess,g.onFailure=e.onFailure,this.send(g,t.metaConnect)}}this._debug("Transport",this.getType(),"sending request",t.id,"envelope",d);try{var v=!0;this.jsonpSend({transport:this,url:d.url,sync:d.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(d.messages),onSuccess:function(e){var i=!1;try{var r=n.convertToMessages(e);0===r.length?n.transportFailure(d,t,{httpCode:204}):(i=!0,n.transportSuccess(d,t,r))}catch(e){n._debug(e),i||n.transportFailure(d,t,{exception:e})}},onError:function(e,i){var r={reason:e,exception:i};v?n.setTimeout((function(){n.transportFailure(d,t,r)}),0):n.transportFailure(d,t,r)}}),v=!1}catch(e){this.setTimeout((function(){n.transportFailure(d,t,{exception:e})}),0)}},t},c=function(){var e,t=new r,i=r.derive(t),s=!0,o=!1,a=!0,c=null,l=null,u=!1,d=null;function h(e,t){e&&(this.webSocketClose(e,t.code,t.reason),this.onClose(e,t))}function p(e){return e===l||e===c}function f(e,t,n){for(var i=[],r=0;r<t.messages.length;++r){var s=t.messages[r];s.id&&i.push(s.id)}e.envelopes[i.join(",")]=[t,n],this._debug("Transport",this.getType(),"stored envelope, envelopes",e.envelopes)}function g(t){if(!l){var n=e.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",n);try{var i=e.getConfiguration().protocol;t.webSocket=i?new window.WebSocket(n,i):new window.WebSocket(n),l=t}catch(e){throw s=!1,this._debug("Exception while creating WebSocket object",e),e}a=!1!==e.getConfiguration().stickyReconnect;var r=this,u=e.getConfiguration().connectTimeout;u>0&&(t.connectTimer=this.setTimeout((function(){e._debug("Transport",r.getType(),"timed out while connecting to URL",n,":",u,"ms"),h.call(r,t,{code:1e3,reason:"Connect Timeout"})}),u));var d=function(){e._debug("WebSocket onopen",t),t.connectTimer&&r.clearTimeout(t.connectTimer),p(t)?(l=null,c=t,o=!0,r.onOpen(t)):(e._warn("Closing extra WebSocket connection",this,"active connection",c),h.call(r,t,{code:1e3,reason:"Extra Connection"}))},f=function(n){n=n||{code:1e3},e._debug("WebSocket onclose",t,n,"connecting",l,"current",c),t.connectTimer&&r.clearTimeout(t.connectTimer),r.onClose(t,n)},g=function(n){e._debug("WebSocket onmessage",n,t),r.onMessage(t,n)};t.webSocket.onopen=d,t.webSocket.onclose=f,t.webSocket.onerror=function(){f({code:1e3,reason:"Error"})},t.webSocket.onmessage=g,this._debug("Transport",this.getType(),"configured callbacks on",t)}}function v(t,n,i){var r=JSON.stringify(n.messages);t.webSocket.send(r),this._debug("Transport",this.getType(),"sent",n,"/meta/connect =",i);var s=this.getConfiguration().maxNetworkDelay,o=s;i&&(o+=this.getAdvice().timeout,u=!0);for(var a=this,c=[],l=0;l<n.messages.length;++l)!function(){var i=n.messages[l];i.id&&(c.push(i.id),t.timeouts[i.id]=a.setTimeout((function(){e._debug("Transport",a.getType(),"timing out message",i.id,"after",o,"on",t),h.call(a,t,{code:1e3,reason:"Message Timeout"})}),o))}();this._debug("Transport",this.getType(),"waiting at most",o,"ms for messages",c,"maxNetworkDelay",s,", timeouts:",t.timeouts)}function y(e,t,n){try{null===e?(e=l||{envelopes:{},timeouts:{}},f.call(this,e,t,n),g.call(this,e)):(f.call(this,e,t,n),v.call(this,e,t,n))}catch(t){var i=this;this.setTimeout((function(){h.call(i,e,{code:1e3,reason:"Exception",exception:t})}),0)}}return i.reset=function(e){t.reset(e),s=!0,e&&(o=!1),a=!0,c=null,l=null,u=!1},i._notifySuccess=function(e,t){e.call(this,t)},i._notifyFailure=function(e,t,n,i){e.call(this,t,n,i)},i.onOpen=function(e){var t=e.envelopes;for(var n in this._debug("Transport",this.getType(),"opened",e,"pending messages",t),t)if(t.hasOwnProperty(n)){var i=t[n],r=i[0],s=i[1];d=r.onSuccess,v.call(this,e,r,s)}},i.onMessage=function(e,t){this._debug("Transport",this.getType(),"received websocket message",t,e);for(var i=!1,r=this.convertToMessages(t.data),s=[],o=0;o<r.length;++o){var a=r[o];if((/^\/meta\//.test(a.channel)||void 0===a.data)&&a.id){s.push(a.id);var c=e.timeouts[a.id];c&&(this.clearTimeout(c),delete e.timeouts[a.id],this._debug("Transport",this.getType(),"removed timeout for message",a.id,", timeouts",e.timeouts))}"/meta/connect"===a.channel&&(u=!1),"/meta/disconnect"!==a.channel||u||(i=!0)}for(var l=!1,h=e.envelopes,p=0;p<s.length;++p){var f=s[p];for(var g in h)if(h.hasOwnProperty(g)){var v=g.split(","),y=n.inArray(f,v);if(y>=0){l=!0,v.splice(y,1);var m=h[g][0],b=h[g][1];delete h[g],v.length>0&&(h[v.join(",")]=[m,b]);break}}}l&&this._debug("Transport",this.getType(),"removed envelope, envelopes",h),this._notifySuccess(d,r),i&&this.webSocketClose(e,1e3,"Disconnect")},i.onClose=function(e,t){this._debug("Transport",this.getType(),"closed",e,t),p(e)&&(s=a&&o,l=null,c=null);var n=e.timeouts;for(var i in e.timeouts={},n)n.hasOwnProperty(i)&&this.clearTimeout(n[i]);var r=e.envelopes;for(var d in e.envelopes={},r)if(r.hasOwnProperty(d)){var h=r[d][0];r[d][1]&&(u=!1);var f={websocketCode:t.code,reason:t.reason};t.exception&&(f.exception=t.exception),this._notifyFailure(h.onFailure,e,h.messages,f)}},i.registered=function(n,i){t.registered(n,i),e=i},i.accept=function(t,n,i){return this._debug("Transport",this.getType(),"accept, supported:",s),s&&!!window.WebSocket&&!1!==e.websocketEnabled},i.send=function(e,t){this._debug("Transport",this.getType(),"sending",e,"/meta/connect =",t),y.call(this,c,e,t)},i.webSocketClose=function(e,t,n){try{e.webSocket&&e.webSocket.close(t,n)}catch(e){this._debug(e)}},i.abort=function(){t.abort(),h.call(this,c,{code:1e3,reason:"Abort"}),this.reset(!0)},i},l=function(r){var s,l,u,d,h,p=new e,f=this,g=r||"default",v=!1,y=new i,m="disconnected",b=0,T=null,O=0,S=[],E=!1,U=0,w={},C=0,j=null,A=[],R={},_={},H={},k=!1,I=!1,x=0,N=0,D=null,P={useWorkerScheduler:!0,protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function L(e,t){try{return e[t]}catch(e){return}}function F(e){return n.isString(e)}function $(e){return null!=e&&"function"==typeof e}function B(e,t){for(var n="";--t>0&&!(e>=Math.pow(10,t));)n+="0";return n+=e}function M(e,t){if(window.console){var n=window.console[e];if($(n)){var i=new Date;[].splice.call(t,0,0,B(i.getHours(),2)+":"+B(i.getMinutes(),2)+":"+B(i.getSeconds(),2)+"."+B(i.getMilliseconds(),3)),n.apply(window.console,t)}}}function G(e){return new RegExp("(^https?://)?(((\\[[^\\]]+])|([^:/?#]+))(:(\\d+))?)?([^?#]*)(.*)?").exec(e)}function q(e){f._debug("Configuring cometd object with",e),F(e)&&(e={url:e}),e||(e={}),P=f._mixin(!1,P,e);var n=f.getURL();if(!n)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var i=G(n),r=i[2],s=i[8],o=i[9];if(v=f._isCrossDomain(r),P.appendMessageTypeToURL)if(void 0!==o&&o.length>0)f._info("Appending message type to URI "+s+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),P.appendMessageTypeToURL=!1;else{var a=s.split("/"),c=a.length-1;s.match(/\/$/)&&(c-=1),a[c].indexOf(".")>=0&&(f._info("Appending message type to URI "+s+" is not supported, disabling 'appendMessageTypeToURL' configuration"),P.appendMessageTypeToURL=!1)}if(window.Worker&&window.Blob&&window.URL&&P.useWorkerScheduler){var l=t.toString();l=l.substring(l.indexOf("{")+1,l.lastIndexOf("}"));var u=new window.Blob([l],{type:"application/json"}),d=window.URL.createObjectURL(u),h=new window.Worker(d);p.setTimeout=function(e,t){var n=p.register(e);return h.postMessage({id:n,type:"setTimeout",delay:t}),n},p.clearTimeout=function(e){p.unregister(e),h.postMessage({id:e,type:"clearTimeout"})},h.onmessage=function(e){var t=e.data.id,n=p.unregister(t);n&&n()}}}function V(e){if(e){var t=w[e.channel];t&&t[e.id]&&(delete t[e.id],f._debug("Removed",e.listener?"listener":"subscription",e))}}function J(e){e&&!e.listener&&V(e)}function W(){for(var e in w)if(w.hasOwnProperty(e)){var t=w[e];if(t)for(var n in t)t.hasOwnProperty(n)&&J(t[n])}}function X(e){m!==e&&(f._debug("Status",m,"->",e),m=e)}function K(){return"disconnecting"===m||"disconnected"===m}function Q(){return""+ ++b}function Y(e,t,n,i,r){try{return t.call(e,i)}catch(e){var s=f.onExtensionException;if($(s)){f._debug("Invoking extension exception handler",n,e);try{s.call(f,e,n,r,i)}catch(e){f._info("Exception during execution of extension exception handler",n,e)}}else f._info("Exception during execution of extension",n,e);return i}}function z(e){for(var t=0;t<A.length&&null!=e;++t){var n=A[t],i=n.extension.incoming;if($(i)){var r=Y(n.extension,i,n.name,e,!1);e=void 0===r?e:r}}return e}function Z(e){for(var t=A.length-1;t>=0&&null!=e;--t){var n=A[t],i=n.extension.outgoing;if($(i)){var r=Y(n.extension,i,n.name,e,!0);e=void 0===r?e:r}}return e}function ee(e,t){var n=w[e];if(n)for(var i in n)if(n.hasOwnProperty(i)){var r=n[i];if(r)try{r.callback.call(r.scope,t)}catch(e){var s=f.onListenerException;if($(s)){f._debug("Invoking listener exception handler",r,e);try{s.call(f,e,r,r.listener,t)}catch(e){f._info("Exception during execution of listener exception handler",r,e)}}else f._info("Exception during execution of listener",r,t,e)}}}function te(e,t){ee(e,t);for(var n=e.split("/"),i=n.length-1,r=i;r>0;--r){var s=n.slice(0,r).join("/")+"/*";r===i&&ee(s,t),ee(s+="*",t)}}function ne(){null!==j&&f.clearTimeout(j),j=null}function ie(e,t){ne();var n=R.interval+t;f._debug("Function scheduled in",n,"ms, interval =",R.interval,"backoff =",C,e),j=f.setTimeout(e,n)}function re(e,t,n){for(var i=0;i<e.length;++i){var r=e[i],o=r.id;T&&(r.clientId=T),null!=(r=Z(r))?(r.id=o,e[i]=r):(delete _[o],e.splice(i--,1))}if(0!==e.length){t&&(D=e[0]);var a=f.getURL();P.appendMessageTypeToURL&&(a.match(/\/$/)||(a+="/"),n&&(a+=n));var c={url:a,sync:!1,messages:e,onSuccess:function(e){try{d.call(f,e)}catch(e){f._info("Exception during handling of messages",e)}},onFailure:function(e,t,n){try{var i=f.getTransport();n.connectionType=i?i.getType():"unknown",h.call(f,e,t,n)}catch(e){f._info("Exception during handling of failure",e)}}};f._debug("Send",c),s.send(c,t)}}function se(e){O>0||!0===E?S.push(e):re([e],!1)}function oe(){C=0}function ae(){return C<P.maxBackoff&&(C+=P.backoffIncrement),C}function ce(){++O,f._debug("Starting batch, depth",O)}function le(){var e=S;S=[],e.length>0&&re(e,!1)}function ue(){if(--O,f._debug("Ending batch, depth",O),O<0)throw"Calls to startBatch() and endBatch() are not paired";0!==O||K()||E||le()}function de(){if(!K()){var e={id:Q(),channel:"/meta/connect",connectionType:s.getType()};I||(e.advice={timeout:0}),X("connecting"),f._debug("Connect sent",e),re([e],!0,"connect"),X("connected")}}function he(e){X("connecting"),ie((function(){de()}),e)}function pe(e){e&&(R=f._mixin(!1,{},P.advice,e),f._debug("New advice",R))}function fe(e){if(ne(),e&&s&&s.abort(),v=!1,s=null,X("disconnected"),T=null,O=0,oe(),k=!1,I=!1,x=0,D=null,S.length>0){var t=S;S=[],h.call(f,void 0,t,{reason:"Disconnected"})}}function ge(e,t,n){var i=f.onTransportException;if($(i)){f._debug("Invoking transport exception handler",e,t,n);try{i.call(f,n,e,t)}catch(e){f._info("Exception during execution of transport exception handler",e)}}}function ve(e,t){$(e)&&(t=e,e=void 0),T=null,W(),K()&&y.reset(!0),pe({}),O=0,E=!0,l=e,u=t;var n="1.0",i=f.getURL(),r=y.findTransportTypes(n,v,i),o={id:Q(),version:n,minimumVersion:n,channel:"/meta/handshake",supportedConnectionTypes:r,advice:{timeout:R.timeout,interval:R.interval}},a=f._mixin(!1,{},l,o);if(f._putCallback(a.id,t),!s&&!(s=y.negotiateTransport(r,n,v,i))){var c="Could not find initial transport among: "+y.getTransportTypes();throw f._warn(c),c}f._debug("Initial transport is",s.getType()),X("handshaking"),f._debug("Handshake sent",a),re([a],!1,"handshake")}function ye(e){X("handshaking"),E=!0,ie((function(){ve(l,u)}),e)}function me(e,t){try{e.call(f,t)}catch(e){var n=f.onCallbackException;if($(n)){f._debug("Invoking callback exception handler",e);try{n.call(f,e,t)}catch(e){f._info("Exception during execution of callback exception handler",e)}}else f._info("Exception during execution of message callback",e)}}function be(e){var t=f._getCallback([e.id]);$(t)&&(delete _[e.id],me(t,e))}function Te(e){var t=H[e.id];if(delete H[e.id],t){f._debug("Handling remote call response for",e,"with context",t);var n=t.timeout;n&&f.clearTimeout(n);var i=t.callback;if($(i))return me(i,e),!0}return!1}function Oe(e){f._debug("Transport failure handling",e),e.transport&&(s=e.transport),e.url&&s.setURL(e.url);var t=e.action,n=e.delay||0;switch(t){case"handshake":ye(n);break;case"retry":he(n);break;case"none":fe(!0);break;default:throw"Unknown action "+t}}function Se(e,t){be(e),te("/meta/handshake",e),te("/meta/unsuccessful",e),K()&&(t.action="none"),f.onTransportFailure.call(f,e,t,Oe)}function Ee(e){var t=f.getURL();if(e.successful){var n=f._isCrossDomain(G(t)[2]),i=y.negotiateTransport(e.supportedConnectionTypes,e.version,n,t);if(null===i)return e.successful=!1,void Se(e,{cause:"negotiation",action:"none",transport:null});s!==i&&(f._debug("Transport",s.getType(),"->",i.getType()),s=i),T=e.clientId,E=!1,le(),e.reestablish=k,k=!0,be(e),te("/meta/handshake",e),N=e["x-messages"]||0;var r=K()?"none":R.reconnect||"retry";switch(r){case"retry":oe(),0===N?he(0):f._debug("Processing",N,"handshake-delivered messages");break;case"none":fe(!0);break;default:throw"Unrecognized advice action "+r}}else Se(e,{cause:"unsuccessful",action:R.reconnect||"handshake",transport:s})}function Ue(e){Se(e,{cause:"failure",action:"handshake",transport:null})}function we(e){return"disconnected"===m||!(!D||D.id!==e.id)&&(D=null,!0)}function Ce(e,t){te("/meta/connect",e),te("/meta/unsuccessful",e),K()&&(t.action="none"),f.onTransportFailure.call(f,e,t,Oe)}function je(e){if(we(e))if(I=e.successful){te("/meta/connect",e);var t=K()?"none":R.reconnect||"retry";switch(t){case"retry":oe(),he(C);break;case"none":fe(!1);break;default:throw"Unrecognized advice action "+t}}else Ce(e,{cause:"unsuccessful",action:R.reconnect||"retry",transport:s});else f._debug("Mismatched /meta/connect reply",e)}function Ae(e){we(e)?(I=!1,Ce(e,{cause:"failure",action:"retry",transport:null})):f._debug("Mismatched /meta/connect failure",e)}function Re(e){fe(!0),be(e),te("/meta/disconnect",e),te("/meta/unsuccessful",e)}function _e(e){e.successful?(fe(!1),be(e),te("/meta/disconnect",e)):Re(e)}function He(e){Re(e)}function ke(e){var t=w[e.subscription];if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&!i.listener&&(delete t[n],f._debug("Removed failed subscription",i))}be(e),te("/meta/subscribe",e),te("/meta/unsuccessful",e)}function Ie(e){e.successful?(be(e),te("/meta/subscribe",e)):ke(e)}function xe(e){ke(e)}function Ne(e){be(e),te("/meta/unsubscribe",e),te("/meta/unsuccessful",e)}function De(e){e.successful?(be(e),te("/meta/unsubscribe",e)):Ne(e)}function Pe(e){Ne(e)}function Le(e){Te(e)||(be(e),te("/meta/publish",e),te("/meta/unsuccessful",e))}function Fe(e){void 0!==e.data?Te(e)||(te(e.channel,e),N>0&&0==--N&&(f._debug("Processed last handshake-delivered message"),he(0))):void 0===e.successful?f._warn("Unknown Bayeux Message",e):e.successful?(be(e),te("/meta/publish",e)):Le(e)}function $e(e){Le(e)}function Be(e){if(x=0,null!=(e=z(e)))switch(pe(e.advice),e.channel){case"/meta/handshake":Ee(e);break;case"/meta/connect":je(e);break;case"/meta/disconnect":_e(e);break;case"/meta/subscribe":Ie(e);break;case"/meta/unsubscribe":De(e);break;default:Fe(e)}}function Me(e){var t=w[e];if(t)for(var n in t)if(t.hasOwnProperty(n)&&t[n])return!0;return!1}function Ge(e,t){var n={scope:e,method:t};if($(e))n.scope=void 0,n.method=e;else if(F(t)){if(!e)throw"Invalid scope "+e;if(n.method=e[t],!$(n.method))throw"Invalid callback "+t+" for scope "+e}else if(!$(t))throw"Invalid callback "+t;return n}function qe(e,t,n,i){var r=Ge(t,n);f._debug("Adding",i?"listener":"subscription","on",e,"with scope",r.scope,"and callback",r.method);var s=++U,o={id:s,channel:e,scope:r.scope,callback:r.method,listener:i},a=w[e];return a||(a={},w[e]=a),a[s]=o,f._debug("Added",i?"listener":"subscription",o),o}this._mixin=function(e,t,n){for(var i=t||{},r=2;r<arguments.length;++r){var s=arguments[r];if(null!=s)for(var o in s)if(s.hasOwnProperty(o)){var a=L(s,o),c=L(i,o);if(a===t)continue;if(void 0===a)continue;if(e&&"object"==typeof a&&null!==a)if(a instanceof Array)i[o]=this._mixin(e,c instanceof Array?c:[],a);else{var l="object"!=typeof c||c instanceof Array?{}:c;i[o]=this._mixin(e,l,a)}else i[o]=a}}return i},this._warn=function(){M("warn",arguments)},this._info=function(){"warn"!==P.logLevel&&M("info",arguments)},this._debug=function(){"debug"===P.logLevel&&M("debug",arguments)},this._isCrossDomain=function(e){return!!(window.location&&window.location.host&&e)&&e!==window.location.host},this.send=se,this._getCallback=function(e){return _[e]},this._putCallback=function(e,t){var n=this._getCallback(e);return $(t)&&(_[e]=t),n},this.onTransportFailure=function(e,t,n){this._debug("Transport failure",t,"for",e);var i=this.getTransportRegistry(),r=this.getURL(),o=this._isCrossDomain(G(r)[2]),a="1.0",c=i.findTransportTypes(a,o,r);if("none"===t.action){if("/meta/handshake"===e.channel&&!t.transport){var l="Could not negotiate transport, client=["+c+"], server=["+e.supportedConnectionTypes+"]";this._warn(l),ge(s.getType(),null,{reason:l,connectionType:s.getType(),transport:s})}}else if(t.delay=this.getBackoffPeriod(),"/meta/handshake"===e.channel){if(!t.transport){var u=s?s.getType():null,d=i.negotiateTransport(c,a,o,r);if(d){var h=d.getType();this._debug("Transport",u,"->",h),ge(u,h,e.failure),t.action="handshake",t.transport=d}else this._warn("Could not negotiate transport, client=["+c+"]"),ge(u,null,e.failure),t.action="none"}"none"!==t.action&&this.increaseBackoffPeriod()}else{var p=(new Date).getTime();if(0===x&&(x=p),"retry"===t.action){t.delay=this.increaseBackoffPeriod();var g=R.maxInterval;if(g>0){var v=R.timeout+R.interval+g;p-x+C>v&&(t.action="handshake")}}"handshake"===t.action&&(t.delay=0,i.reset(!1),this.resetBackoffPeriod())}n.call(f,t)},this.receive=Be,d=function(e){f._debug("Received",e);for(var t=0;t<e.length;++t)Be(e[t])},h=function(e,t,n){f._debug("handleFailure",e,t,n),n.transport=e;for(var i=0;i<t.length;++i){var r=t[i],s={id:r.id,successful:!1,channel:r.channel,failure:n};switch(n.message=r,r.channel){case"/meta/handshake":Ue(s);break;case"/meta/connect":Ae(s);break;case"/meta/disconnect":He(s);break;case"/meta/subscribe":s.subscription=r.subscription,xe(s);break;case"/meta/unsubscribe":s.subscription=r.subscription,Pe(s);break;default:$e(s)}}},this.registerTransport=function(e,t,n){var i=y.add(e,t,n);return i&&(this._debug("Registered transport",e),$(t.registered)&&t.registered(e,this)),i},this.unregisterTransport=function(e){var t=y.remove(e);return null!==t&&(this._debug("Unregistered transport",e),$(t.unregistered)&&t.unregistered()),t},this.unregisterTransports=function(){y.clear()},this.getTransportTypes=function(){return y.getTransportTypes()},this.findTransport=function(e){return y.find(e)},this.getTransportRegistry=function(){return y},this.configure=function(e){q.call(this,e)},this.init=function(e,t){this.configure(e),this.handshake(t)},this.handshake=function(e,t){if("disconnected"!==m)throw"Illegal state: handshaken";ve(e,t)},this.disconnect=function(e,t){if(!K()){$(e)&&(t=e,e=void 0);var n={id:Q(),channel:"/meta/disconnect"},i=this._mixin(!1,{},e,n);f._putCallback(i.id,t),X("disconnecting"),re([i],!1,"disconnect")}},this.startBatch=function(){ce()},this.endBatch=function(){ue()},this.batch=function(e,t){var n=Ge(e,t);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(e){throw this._info("Exception during execution of batch",e),this.endBatch(),e}},this.addListener=function(e,t,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!F(e))throw"Illegal argument type: channel must be a string";return qe(e,t,n,!0)},this.removeListener=function(e){if(!e||!e.channel||!("id"in e))throw"Invalid argument: expected subscription, not "+e;V(e)},this.clearListeners=function(){w={}},this.subscribe=function(e,t,n,i,r){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!F(e))throw"Illegal argument type: channel must be a string";if(K())throw"Illegal state: disconnected";$(t)&&(r=i,i=n,n=t,t=void 0),$(i)&&(r=i,i=void 0);var s=!Me(e),o=qe(e,t,n,!1);if(s){var a={id:Q(),channel:"/meta/subscribe",subscription:e},c=this._mixin(!1,{},i,a);f._putCallback(c.id,r),se(c)}return o},this.unsubscribe=function(e,t,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(K())throw"Illegal state: disconnected";$(t)&&(n=t,t=void 0),this.removeListener(e);var i=e.channel;if(!Me(i)){var r={id:Q(),channel:"/meta/unsubscribe",subscription:i},s=this._mixin(!1,{},t,r);f._putCallback(s.id,n),se(s)}},this.resubscribe=function(e,t){if(J(e),e)return this.subscribe(e.channel,e.scope,e.callback,t)},this.clearSubscriptions=function(){W()},this.publish=function(e,t,n,i){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!F(e))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(K())throw"Illegal state: disconnected";$(t)?(i=t,t={},n=void 0):$(n)&&(i=n,n=void 0);var r={id:Q(),channel:e,data:t},s=this._mixin(!1,{},n,r);f._putCallback(s.id,i),se(s)},this.publishBinary=function(e,t,n,i,r){$(t)?(r=t,t=new ArrayBuffer(0),n=!0,i=void 0):$(n)?(r=n,n=!0,i=void 0):$(i)&&(r=i,i=void 0);var s={meta:i,data:t,last:n},o={ext:{binary:{}}};this.publish(e,s,o,r)},this.remoteCall=function(e,t,n,i,r){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!F(e))throw"Illegal argument type: target must be a string";if(K())throw"Illegal state: disconnected";if($(t)?(r=t,t={},n=P.maxNetworkDelay,i=void 0):$(n)?(r=n,n=P.maxNetworkDelay,i=void 0):$(i)&&(r=i,i=void 0),"number"!=typeof n)throw"Illegal argument type: timeout must be a number";e.match(/^\//)||(e="/"+e);var s="/service"+e,o={id:Q(),channel:s,data:t},a=this._mixin(!1,{},i,o),c={callback:r};n>0&&(c.timeout=f.setTimeout((function(){f._debug("Timing out remote call",a,"after",n,"ms"),Le({id:a.id,error:"406::timeout",successful:!1,failure:{message:a,reason:"Remote Call Timeout"}})}),n),f._debug("Scheduled remote call timeout",a,"in",n,"ms")),H[a.id]=c,se(a)},this.remoteCallBinary=function(e,t,n,i,r,s){$(t)?(s=t,t=new ArrayBuffer(0),n=!0,i=void 0,r=P.maxNetworkDelay):$(n)?(s=n,n=!0,i=void 0,r=P.maxNetworkDelay):$(i)?(s=i,i=void 0,r=P.maxNetworkDelay):$(r)&&(s=r,r=P.maxNetworkDelay);var o={meta:i,data:t,last:n},a={ext:{binary:{}}};this.remoteCall(e,o,r,a,s)},this.getStatus=function(){return m},this.isDisconnected=K,this.setBackoffIncrement=function(e){P.backoffIncrement=e},this.getBackoffIncrement=function(){return P.backoffIncrement},this.getBackoffPeriod=function(){return C},this.increaseBackoffPeriod=function(){return ae()},this.resetBackoffPeriod=function(){oe()},this.setLogLevel=function(e){P.logLevel=e},this.registerExtension=function(e,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!F(e))throw"Illegal argument type: extension name must be a string";for(var n=!1,i=0;i<A.length;++i)if(A[i].name===e){n=!0;break}return n?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(A.push({name:e,extension:t}),this._debug("Registered extension",e),$(t.registered)&&t.registered(e,this),!0)},this.unregisterExtension=function(e){if(!F(e))throw"Illegal argument type: extension name must be a string";for(var t=!1,n=0;n<A.length;++n){var i=A[n];if(i.name===e){A.splice(n,1),t=!0,this._debug("Unregistered extension",e);var r=i.extension;$(r.unregistered)&&r.unregistered();break}}return t},this.getExtension=function(e){for(var t=0;t<A.length;++t){var n=A[t];if(n.name===e)return n.extension}return null},this.getName=function(){return g},this.getClientId=function(){return T},this.getURL=function(){if(s){var e=s.getURL();if(e)return e;if(e=P.urls[s.getType()])return e}return P.url},this.getTransport=function(){return s},this.getConfiguration=function(){return this._mixin(!0,{},P)},this.getAdvice=function(){return this._mixin(!0,{},R)},this.setTimeout=function(e,t){return p.setTimeout((function(){try{f._debug("Invoking timed function",e),e()}catch(t){f._debug("Exception invoking timed function",e,t)}}),t)},this.clearTimeout=function(e){p.clearTimeout(e)},window.WebSocket&&this.registerTransport("websocket",new c),this.registerTransport("long-polling",new o),this.registerTransport("callback-polling",new a)},u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],d=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:l,Transport:r,RequestTransport:s,LongPollingTransport:o,CallbackPollingTransport:a,WebSocketTransport:c,Utils:n,Z85:{encode:function(e){var t=null;if(e instanceof ArrayBuffer?t=e:e.buffer instanceof ArrayBuffer?t=e.buffer:Array.isArray(e)&&(t=new Uint8Array(e).buffer),null==t)throw"Cannot Z85 encode "+e;for(var n=t.byteLength,i=n%4,r=4-(0===i?4:i),s=new DataView(t),o="",a=0,c=0;c<n+r;++c){var l=c>=n;if(a=256*a+(l?0:s.getUint8(c)),(c+1)%4==0){for(var d=52200625,h=5;h>0;--h){if(!l||h>r){var p=Math.floor(a/d)%85;o+=u[p]}d/=85}a=0}}return o},decode:function(e){for(var t=e.length%5,n=5-(0===t?5:t),i=0;i<n;++i)e+=u[u.length-1];for(var r=e.length,s=new ArrayBuffer(4*r/5-n),o=new DataView(s),a=0,c=0,l=0,h=0;h<r;++h){var p=e.charCodeAt(c++)-32;if(a=85*a+d[p],c%5==0){for(var f=16777216;f>=1;)l<o.byteLength&&o.setUint8(l++,Math.floor(a/f)%256),f/=256;a=0}}return s}}}}()},48055:(e,t)=>{var n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global,i=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n=void 0!==e&&e||"undefined"!=typeof self&&self||void 0!==n&&n,i="URLSearchParams"in n,r="Symbol"in n&&"iterator"in Symbol,s="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in n,a="ArrayBuffer"in n;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function f(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function v(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&s&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=f(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=f(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(v)}),this.text=function(){var e,t,n,i=f(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=g(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=u(e),t=d(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[u(e)]},p.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},p.prototype.set=function(e,t){this.map[u(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},r&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function T(e,t){if(!(this instanceof T))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,r=(t=t||{}).body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),b.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var s=/([?&])_=[^&]*/;if(s.test(this.url))this.url=this.url.replace(s,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function O(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(r))}})),t}function S(e,t){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},m.call(T.prototype),m.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},S.error=function(){var e=new S(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];S.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new S(null,{status:t,headers:{location:e}})},t.DOMException=n.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function U(e,i){return new Promise((function(r,o){var c=new T(e,i);if(c.signal&&c.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function u(){l.abort()}l.onload=function(){var e,t,n={status:l.status,statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();t.append(i,r)}})),t)};n.url="responseURL"in l?l.responseURL:n.headers.get("X-Request-URL");var i="response"in l?l.response:l.responseText;setTimeout((function(){r(new S(i,n))}),0)},l.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){o(new t.DOMException("Aborted","AbortError"))}),0)},l.open(c.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(s?l.responseType="blob":a&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!i||"object"!=typeof i.headers||i.headers instanceof p?c.headers.forEach((function(e,t){l.setRequestHeader(t,e)})):Object.getOwnPropertyNames(i.headers).forEach((function(e){l.setRequestHeader(e,d(i.headers[e]))})),c.signal&&(c.signal.addEventListener("abort",u),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",u)}),l.send(void 0===c._bodyInit?null:c._bodyInit)}))}U.polyfill=!0,n.fetch||(n.fetch=U,n.Headers=p,n.Request=T,n.Response=S),t.Headers=p,t.Request=T,t.Response=S,t.fetch=U}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=n.fetch?n:i;(t=r.fetch).default=r.fetch,t.fetch=r.fetch,t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response,e.exports=t},57312:e=>{e.exports="object"==typeof self?self.FormData:window.FormData},56893:(e,t,n)=>{const i=n(57323);e.exports={CometD:i.CometD,default:i}}}]);