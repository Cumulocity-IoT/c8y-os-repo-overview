<c8y-title>Cumulocity Opensource</c8y-title>

<c8y-action-bar-item>
  <c8y-list-display-switch
    class="form-inline"
    (onListClassChange)="listClass = $event"
  ></c8y-list-display-switch>
</c8y-action-bar-item>

<c8y-action-bar-item>
  <div class="input-group input-group-search m-t-4" id="search">
    <input
      class="form-control"
      placeholder="Filterâ€¦"
      type="search"
      [ngModel]="searchText"
      (ngModelChange)="searchText = $event"
    />
    <span class="input-group-addon">
      <i c8yIcon="search" *ngIf="!searchText; else clearFilterString"></i>
      <ng-template #clearFilterString>
        <i class="text-muted" c8yIcon="times" (click)="searchText = ''"></i>
      </ng-template>
    </span>
  </div>
</c8y-action-bar-item>

<c8y-action-bar-item>
  <div class="c8y-select-wrapper">
    <select [(ngModel)]="category" class="form-control">
      <option [ngValue]="''">All</option>
      <option *ngFor="let option of categoryOptions" [ngValue]="option">
        {{ option }}
      </option>
    </select>
  </div>
</c8y-action-bar-item>

<c8y-action-bar-item>
  <div class="c8y-select-wrapper">
    <select [(ngModel)]="trust" class="form-control">
      <option [ngValue]="''">Any</option>
      <option *ngFor="let option of trustOptions" [ngValue]="option">
        {{ option }}
      </option>
    </select>
  </div>
</c8y-action-bar-item>

<ng-template #loadingIndicator>
  <c8y-loading></c8y-loading>
</ng-template>

<div
  *ngIf="!loading; else loadingIndicator"
  class="card-group"
  [ngClass]="listClass"
>
  <div
    class="col-sm-6 col-md-4 col-lg-4 col-xs-12"
    *ngFor="let repo of repos | repoFilter : searchText : category : trust"
  >
    <div class="card">
      <!-- <div class="card-actions">
        <div class="dropdown" dropdown>
          <button type="button" title="dropdown-toggle" dropdownToggle class="dropdown-toggle c8y-dropdown">
            <i c8yIcon="ellipsis-v"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-right" *dropdownMenu>
            <li>
              <button title="Edit" type="button">
                <i c8yIcon="edit"></i>
                Edit
              </button>
            </li>
            <li>
              <button title="Duplicate" type="button">
                <i c8yIcon="clone"></i>
                Duplicate
              </button>
            </li>
            <li>
              <button title="Delete" type="button">
                <i c8yIcon="delete"></i>
                Delete
              </button>
            </li>
          </ul>
        </div>
      </div> -->
      <div class="card-header separator">
        <!-- <div class="card-icon">
          <i class="c8y-icon-duocolor" c8yIcon="github"></i>
        </div> -->
        <div class="d-flex flex-grow">
          <div class="flex-grow">
            <p class="card-title">
              <c8y-highlight
                [text]="repo.name || ''"
                [pattern]="searchText"
                [shouldTrimPattern]="true"
              ></c8y-highlight>
            </p>
          </div>

          <a
            *ngIf="repo | installHref | async as installHrefForRepo"
            class="btn-primary btn-sm"
            title="Install"
            [routerLink]="installHrefForRepo"
          >
            Install
          </a>

          <a
            class="btn btn-default btn-icon btn-sm"
            target="_blank"
            [href]="repo.url"
            nofollow
            noreferrer
            ><i c8yIcon="github"></i
          ></a>
        </div>
      </div>
      <div class="card-block card-column-30 m-r-0">
        <p>
          <c8y-highlight
            [text]="repo.desc || ''"
            [pattern]="searchText"
            [shouldTrimPattern]="true"
          ></c8y-highlight>
        </p>
      </div>
      <div class="card-footer separator card-column-30">
        <div class="d-flex fit-w">
          <div class="card-column-30 flex-grow">
            <span class="text-label-small m-r-4">
              <i c8yIcon="star"></i>
              {{ repo.stars }}
            </span>
          </div>
          <div class="card-column-30">
            <span class="text-label-small m-r-4">
              <i c8yIcon="codefork"></i>
              {{ "-" }}
            </span>
          </div>
          <div class="card-column-30">
            <span class="text-label-small m-r-4">
              <i c8yIcon="clock"></i>
              {{ repo.last_updated | c8yDate }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
